{"version":3,"sources":["assets/images/icons/WhatsApp.svg","assets/images/icons/Twitter.png","assets/images/icons/Facebook.png","assets/images/icons/Gmail.png","assets/images/icons/Telegram.png","assets/images/icons/Pinterest.png","assets/images/icons/Reddit.png","assets/images/icons/Tumblr.png","assets/images/icons/Skype.png","assets/images/icons/FBMessenger.png","components/Dialogs/components/Select.js","components/Dialogs/components/Switch.js","utils/withBackButtonSupport.js","components/Dialogs/TextboxSettingsDialog.js","config/constants.js","utils/useSnapshots.js","components/Canvas/Elements/makeElement.js","utils/fitText.js","components/Canvas/Elements/Textbox.js","components/Dialogs/ImageSettingsDialog.js","components/Canvas/Elements/Sticker.js","components/Canvas/Grid.js","components/Dialogs/BorderDialog.js","components/Dialogs/ShareDialog.js","utils/dataURLToFile.js","utils/cache.js","utils/API.js","utils/uploadImage.js","components/Dialogs/ImageDialog.js","utils/downloadImageFromSrc.js","components/Dialogs/GridDialog.js","utils/importFile.js","utils/generateImage.js","components/Canvas/Canvas.js","components/BottomBar/Menu.js","components/Dialogs/ConfirmDialog.js","components/Dialogs/components/Templates.js","components/Dialogs/components/Stickers.js","components/Dialogs/TemplatesDialog.js","components/Dialogs/HelpDialog.js","components/Dialogs/AuthDialog.js","components/BottomBar/BottomBar.js","utils/Analytics.js","utils/OfflineUseAlerts.js","App.js","utils/style.js","serviceWorker.js","index.js"],"names":["module","exports","Select","name","label","options","child","className","useFormContext","control","watch","as","props","TextField","select","fullWidth","value","Object","entries","map","MenuItem","key","React","createElement","useStyles","makeStyles","theme","switch","width","register","setValue","classes","FormControlLabel","Switch","inputRef","onChange","event","checked","withBackButtonSupport","childElement","open","onClose","useEffect","window","location","hash","addEventListener","handleClose","ReactGA","modalview","values","removeEventListener","form","padding","spacing","paddingTop","text","whiteSpace","applyButton","marginTop","input","useForm","getValues","handleSubmit","reset","Dialog","style","onSubmit","settingsOptions","colors","color","textAlign","verticalTextAlign","fontFamilies","fontFamily","Button","type","IS_ANDROID_APP","URLSearchParams","search","get","useSnapshots","createSnapshot","applySnapshot","onSnapshotsEmpty","context","useContext","AppContext","snapshots","useRef","addSnapshot","newSnapshot","current","push","length","shift","handleUndo","snapshot","pop","dispatchEvent","CustomEvent","highlight","backgroundColor","border","borderRadius","shape","display","capture","handle","zIndex","height","position","cursor","container","top","flexDirection","alignItems","rotationHandle","button","marginLeft","action","transform","justifyContent","resizeHandles","vertical","left","horizontal","diagonal","makeElement","controls","defaultValues","Child","onRemove","grid","canvas","template","id","lastRotation","rotation","childRef","hasCreatedSnapshot","useState","x","y","setPosition","setRotation","TEXTBOX_PADDING","setHeight","setWidth","setCapture","isFocused","setIsFocused","shouldMove","setShouldMove","dragGrid","useMemo","enabled","fixedSize","clientWidth","columns","clientHeight","rows","image","getRotationAngle","data","childRect","getBoundingClientRect","childCenter","newRotation","Math","atan2","PI","handleRotationStart","emitResize","onResize","calcNewHeight","angle","dy","deltaX","sin","deltaY","cos","newHeight","aspectRatio","newWidth","calcNewWidth","dx","beforeCapturing","afterCapturing","handleClick","contains","target","a","Promise","requestAnimationFrame","onDrag","onStop","disabled","transformOrigin","ref","data-id","onFocus","toggleMovement","state","dimensions","includes","onStart","IconButton","onClick","onEditClicked","onSettingsClicked","fitText","styles","floor","div","document","fontWeight","bold","textTransform","caps","assign","textContent","body","appendChild","fontSize","textfit","multiLine","minFontSize","maxFontSize","innerHeight","span","querySelector","getComputedStyle","parseInt","getNewFontsize","removeChild","globalDefaultSettings","background","outline","typography","settings","resize","userSelect","isEditing","forwardRef","forwardedRef","defaultSettings","textboxRef","shouldEmitSnapshot","dialogOpen","setDialogOpen","setSettings","setIsEditing","handleEditClicked","handleFocusOut","focus","toLowerCase","toObject","toPercentage","useWidth","changedSettings","contentEditable","onMouseDown","onTouchStart","onInput","newValue","imageWrapper","boxSizing","src","alt","keepAspectRatio","flip","imageRef","isDialogOpen","setIsDialogOpen","defineProperty","naturalHeight","naturalWidth","configurable","draggable","line","x1","y1","x2","y2","beginPath","moveTo","lineTo","stroke","pointerEvents","touchAction","Grid","renderContext","config","setDimensions","canvasRect","render","cellWidth","cellHeight","renderGrid","getContext","strokeStyle","fixedSpacing","renderWithRelativeSpacing","then","DialogTitle","FormGroup","innerDrawer","title","paddingBottom","iconsContainer","overflowX","icon","ShareDialog","link","onOpen","encodeURIComponent","openLink","href","detail","replace","SwipeableDrawer","disableDiscovery","disableSwipeToOpen","anchor","PaperProps","WhatsAppIcon","FacebookIcon","TwitterIcon","TelegramIcon","SkypeIcon","FBMessengerIcon","PinterestIcon","RedditIcon","TumblrIcon","GmailIcon","dataURLtoFile","dataurl","filename","arr","split","mime","match","bstr","atob","n","u8arr","Uint8Array","charCodeAt","File","isCacheSupported","cachedRequest","url","fetch","caches","cache","cachedData","navigator","onLine","response","put","clone","getCachedImage","blob","imageURL","URL","createObjectURL","cacheImage","indexOf","path","protocol","hostname","uploadTemplate","formData","method","authorize","password","headers","JSON","stringify","res","json","uploadSticker","registerStickerUse","uploadFile","FormData","append","host","console","error","uploadImage","margin","innerDialog","imageData","uploadButtonWrapper","buttonLoader","linkWrapper","shareButton","snackbarClose","palette","primary","variant","elements","isRegistered","setLink","isUploading","setIsUploading","isShareDialogOpen","setIsShareDialogOpen","isUploadSnackbarOpen","setIsUploadSnackbarOpen","hasCreatedTemplate","setHasCreatedTemplate","registerUsage","currentTemplate","element","undefined","handleUploadClick","file","dataURLToFile","handleShareClick","handleTemplateClick","metaData","textboxes","getTextboxes","getBorder","ok","Paper","Typography","startIcon","CircularProgress","size","download","click","downloadImageFromSrc","defaultValue","Snackbar","anchorOrigin","autoHideDuration","message","spacingError","setSpacingError","fileToImage","resolve","reader","FileReader","onload","result","readAsDataURL","importFile","accept","onchange","e","files","remove","compensateError","clonedDocument","querySelectorAll","forEach","textbox","shiftOffset","min","offsetHeight","Array","from","parent","parentNode","node","reverse","minWidth","minHeight","html2canvas","useCORS","onclone","toDataURL","generateImage","getDimensionsWithoutPadding","parseFloat","paddingLeft","paddingRight","waitFrames","amount","i","defaultBorderValues","bottom","right","defaultGridValues","canvasWrapper","default","mixins","toolbar","overflow","Canvas","idCounter","elementRefs","elementKeys","setElementKeys","borderValues","setBorderValues","gridValues","setGridValues","isBorderDialogOpen","setIsBorderDialogOpen","isImageDialogOpen","setIsImageDialogOpen","isGridDialogOpen","setIsGridDialogOpen","generatedImage","setGeneratedImage","handleImageDialogClose","handleRemoveElement","removeKey","newKeys","filter","clearElements","createNewElement","handleAddTextbox","newElementKey","addSticker","handleImportSticker","base64Image","handleImportImage","set","handleGenerateImage","handleSetBorder","handleSetGrid","handleLoadTemplate","image_url","formatPercentage","object","selector","test","percentage","meta_data","newKey","handleLoadSticker","sticker","handleGetTextboxes","handleGetBorder","imgWidth","imgHeight","imgRatio","maxWidth","maxHeight","borderSize","Error","Menu","anchorEl","ListItemIcon","ListItemText","ConfirmDialog","content","disableBackdropClick","disableEscapeKeyDown","DialogContent","dividers","DialogActions","spacer","searchWrapper","flex","searchClear","listWrapper","list","tile","tilebar","deleteButton","Templates","onLoad","templates","setTemplates","isConfirmDialogOpen","setIsConfirmDialogOpen","setSearch","fetchTemplates","parse","renderTemplates","sort","b","amount_uses","InputBase","placeholder","GridList","GridListTile","tagName","loading","handleImageLoad","GridListTileBar","subtitle","count","handleDeleteClick","shouldDelete","addButton","InnerTile","onDelete","Stickers","active","currentSticker","stickers","setStickers","fetchStickers","handleDelete","handleAddSticker","cols","ReactDOM","createPortal","Zoom","in","unmountOnExit","Fab","getElementById","dialog","appBar","Transition","Slide","direction","currentTab","setCurrentTab","scrollToTop","scrollTo","fullScreen","TransitionComponent","AppBar","Toolbar","edge","Tabs","index","Tab","onChangeIndex","axis","disableLazyLoading","OverlayChild","rect","Tooltip","placement","arrow","ClickAwayListener","onClickAway","isSnackbarOpen","setIsSnackbarOpen","isWrongPassword","setIsWrongPassword","setPassword","helperText","paper","fabButton","flexGrow","BottomBar","openMenuButton","helpButtonTimer","isMenuOpen","setIsMenuOpen","isTemplatesOpen","setIsTemplatesOpen","isHelpOpen","setIsHelpOpen","isAuthDialogOpen","setIsAuthDialogOpen","handleTemplatesClick","handleTouchStart","setTimeout","handleTouchEnd","clearTimeout","onTouchEnd","onMouseUp","AuthDialog","Analytics","isInitialized","setIsInitialized","initialize","pageview","pathname","generateImageEvent","bind","category","loadTemplateEvent","shareModalModalview","uploadImageEvent","downloadImageEvent","shareEvent","OfflineUseAlerts","snackbarText","setSnackbarText","channel","BroadcastChannel","close","createContext","getWidth","outerWidth","outerHeight","App","injectedImage","useTheme","EventTarget","localStorage","getItem","setContext","setter","setItem","ctrlKey","keyCode","handleMessage","handleResize","documentElement","setProperty","boxShadow","shadows","Provider","isLocalhost","Boolean","registerValidSW","swUrl","serviceWorker","registration","onupdatefound","installingWorker","installing","onstatechange","controller","postMessage","log","onUpdate","onSuccess","catch","createMuiTheme","main","ThemeProvider","process","origin","contentType","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.9ceed151.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/WhatsApp.0e878a0f.svg\";","module.exports = __webpack_public_path__ + \"static/media/Twitter.1f5a8ef5.png\";","module.exports = __webpack_public_path__ + \"static/media/Facebook.9ee5d43c.png\";","module.exports = __webpack_public_path__ + \"static/media/Gmail.598d07e7.png\";","module.exports = __webpack_public_path__ + \"static/media/Telegram.b4b9d64f.png\";","module.exports = __webpack_public_path__ + \"static/media/Pinterest.717253e4.png\";","module.exports = __webpack_public_path__ + \"static/media/Reddit.3826daa7.png\";","module.exports = __webpack_public_path__ + \"static/media/Tumblr.93e9138a.png\";","module.exports = __webpack_public_path__ + \"static/media/Skype.5a725d78.png\";","module.exports = __webpack_public_path__ + \"static/media/FBMessenger.f8b3ffc7.png\";","import React from \"react\"\r\nimport { TextField, MenuItem } from \"@material-ui/core\"\r\nimport { Controller, useFormContext } from \"react-hook-form\"\r\n\r\nfunction Select({ name, label, options, child, className }) {\r\n    const { control, watch } = useFormContext()\r\n\r\n    return (\r\n        <Controller\r\n            as={props => (\r\n                <TextField\r\n                    select\r\n                    label={label}\r\n                    fullWidth\r\n                    className={className}\r\n                    value={watch(name)}\r\n                    {...props}\r\n                >\r\n                    {Object.entries(options).map(([label, value]) => (\r\n                        <MenuItem key={value} value={value}>\r\n                            {React.createElement(child, { label, value })}\r\n                        </MenuItem>\r\n                    ))}\r\n                </TextField>\r\n            )}\r\n            control={control}\r\n            name={name}\r\n        />\r\n    )\r\n}\r\n\r\nexport default Select","import React from \"react\"\r\nimport { Switch, FormControlLabel } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport { useFormContext } from \"react-hook-form\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    switch: {\r\n        width: \"100%\"\r\n    }\r\n}))\r\n\r\nfunction Select({ name, label, className }) {\r\n    const { register, watch, setValue } = useFormContext()\r\n\r\n    const classes = useStyles()\r\n\r\n    return (\r\n        <FormControlLabel\r\n            control={\r\n                <Switch\r\n                    name={name}\r\n                    inputRef={register()}\r\n                    onChange={(event, value) => setValue(name, value)}\r\n                    checked={watch(name)}\r\n                />\r\n            }\r\n            label={label}\r\n            className={`${classes.switch} ${className}`}\r\n        />\r\n    )\r\n}\r\n\r\nexport default Select","import React, { useEffect } from \"react\"\r\nimport ReactGA from \"react-ga\"\r\n\r\nfunction withBackButtonSupport(childElement, name) {\r\n    return ({ open, onClose, ...props }) => {\r\n        useEffect(() => {\r\n            if(open) {\r\n                window.location.hash = \"#\" + name\r\n                window.addEventListener(\"popstate\", handleClose)\r\n                ReactGA.modalview(name)\r\n            }\r\n        }, [open])\r\n\r\n        const handleClose = ({ values }) => {\r\n            window.removeEventListener(\"popstate\", handleClose)\r\n            window.location.hash = \"\"\r\n            onClose(values)\r\n        }\r\n\r\n        return React.createElement(childElement, {\r\n            ...props,\r\n            open,\r\n            onClose: values => handleClose({ values })\r\n        })\r\n    }\r\n}\r\n\r\nexport default withBackButtonSupport","import React, { useEffect } from \"react\"\r\nimport { Dialog, Button } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport { useForm, FormContext } from \"react-hook-form\"\r\n\r\nimport Select from \"./components/Select.js\"\r\nimport Switch from \"./components/Switch.js\"\r\n\r\nimport settingsOptions from \"../../config/settings-options.json\"\r\nimport withBackButtonSupport from \"../../utils/withBackButtonSupport.js\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    form: {\r\n        padding: theme.spacing(2),\r\n        paddingTop: 0\r\n    },\r\n\r\n    text: {\r\n        padding: `${theme.spacing(3)}px ${theme.spacing(2)}px`,\r\n        whiteSpace: \"pre\"\r\n    },\r\n\r\n    applyButton: {\r\n        marginTop: theme.spacing(2)\r\n    },\r\n\r\n    input: {\r\n        marginTop: theme.spacing(1)\r\n    }\r\n}))\r\n\r\nfunction TextboxSettingsDialog({ onClose, open, values, text }) {\r\n    const { getValues, handleSubmit, control, watch, reset, register, setValue } = useForm()\r\n\r\n    const classes = useStyles()\r\n\r\n    const handleClose = () => {\r\n        onClose(getValues())\r\n    }\r\n\r\n    useEffect(() => {\r\n        reset(values)\r\n    }, [values, reset])\r\n\r\n    return (\r\n        <Dialog onClose={handleClose} open={open}>\r\n            <div className={classes.text} style={watch()}>\r\n                {text}\r\n            </div>\r\n            \r\n            <FormContext {...{ control, watch, register, setValue }}>\r\n                <form onSubmit={handleSubmit(handleClose)} className={classes.form}>\r\n                    {/* Color */}\r\n                    <Select\r\n                        name=\"color\"\r\n                        label=\"Color\"\r\n                        options={settingsOptions.colors}\r\n                        className={classes.input}\r\n                        child={({ label, value }) => (\r\n                            <span style={{ color: value }}>{label}</span>\r\n                        )}\r\n                    />\r\n\r\n                    {/* Background Color */}\r\n                    <Select\r\n                        name=\"backgroundColor\"\r\n                        label=\"Background Color\"\r\n                        options={{\r\n                            \"Transparent\": \"transparent\",\r\n                            ...settingsOptions.colors\r\n                        }}\r\n                        className={classes.input}\r\n                        child={({ label, value }) => (\r\n                            <span style={{ color: value }}>{label}</span>\r\n                        )}\r\n                    />\r\n\r\n                    {/* Text Align */}\r\n                    <Select\r\n                        name=\"textAlign\"\r\n                        label=\"Text Align\"\r\n                        options={settingsOptions.textAlign}\r\n                        className={classes.input}\r\n                        child={({ label }) => label}\r\n                    />\r\n\r\n                    {/* Vertical Text Align */}\r\n                    <Select\r\n                        name=\"verticalTextAlign\"\r\n                        label=\"Vertical Text Align\"\r\n                        options={settingsOptions.verticalTextAlign}\r\n                        className={classes.input}\r\n                        child={({ label }) => label}\r\n                    />\r\n\r\n                    {/* Font Family */}\r\n                    <Select\r\n                        name=\"fontFamily\"\r\n                        label=\"Font Family\"\r\n                        options={settingsOptions.fontFamilies}\r\n                        className={classes.input}\r\n                        child={({ label, value }) => (\r\n                            <span style={{ fontFamily: value }}>{label}</span>\r\n                        )}\r\n                    />\r\n\r\n                    {/* Bold */}\r\n                    <Switch name=\"bold\" label=\"Bold\" className={classes.input}/>\r\n\r\n                    {/* Caps */}\r\n                    <Switch name=\"caps\" label=\"Caps\" className={classes.input}/>\r\n\r\n                    <Button fullWidth className={classes.applyButton} type=\"submit\">Apply</Button>\r\n                </form>\r\n            </FormContext>\r\n        </Dialog>\r\n    )\r\n}\r\n\r\nexport default withBackButtonSupport(TextboxSettingsDialog, \"settings\")","export const MAX_SNAPSHOTS = 50\r\nexport const TEXTBOX_PLACEHOLDER = \"Enter Text...\"\r\nexport const TEXTBOX_PADDING = 6\r\nexport const LONG_PRESS_DURATION = 1000\r\nexport const IS_DEV = !process.env.NODE_ENV || process.env.NODE_ENV === \"development\"\r\nexport const IS_ANDROID_APP = new URLSearchParams(window.location.search).get(\"isAndroidApp\")\r\nexport const GA_TRACKING_ID = \"UA-162994094-2\"\r\nexport const CACHE_NAME = \"v1\"","import { useContext, useEffect, useRef } from \"react\"\r\n\r\nimport { AppContext } from \"../App.js\"\r\nimport { MAX_SNAPSHOTS } from \"../config/constants.js\"\r\n\r\nfunction useSnapshots({ createSnapshot, applySnapshot, onSnapshotsEmpty }) {\r\n    const context = useContext(AppContext)\r\n\r\n    const snapshots = useRef([])\r\n\r\n    const addSnapshot = () => {\r\n        // Create new snapshot\r\n        const newSnapshot = createSnapshot()\r\n        snapshots.current.push(newSnapshot)\r\n\r\n        // Apply size constraint\r\n        if (snapshots.current.length > MAX_SNAPSHOTS) {\r\n            snapshots.current.shift()\r\n        }\r\n    }\r\n\r\n    const handleUndo = () => {\r\n        // No snapshots left\r\n        if (snapshots.current.length === 0) {\r\n            onSnapshotsEmpty()\r\n            return\r\n        }\r\n\r\n        // Apply snapshot\r\n        const snapshot = snapshots.current.pop()\r\n        applySnapshot(snapshot)\r\n    }\r\n\r\n    useEffect(() => {\r\n        context.event.addEventListener(\"undo\", handleUndo)\r\n        context.event.addEventListener(\"addSnapshot\", addSnapshot)\r\n\r\n        return () => {\r\n            context.event.removeEventListener(\"undo\", handleUndo)\r\n            context.event.removeEventListener(\"addSnapshot\", addSnapshot)\r\n        }\r\n    })\r\n\r\n    return () => {\r\n        context.event.dispatchEvent(new CustomEvent(\"addSnapshot\"))\r\n    }\r\n}\r\n\r\nexport default useSnapshots","import React, { useState, useRef, useMemo, useEffect, useContext } from \"react\"\r\nimport { DraggableCore } from \"react-draggable\"\r\nimport { IconButton } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport RotateLeftIcon from \"@material-ui/icons/RotateLeft\"\r\nimport SettingsIcon from \"@material-ui/icons/Settings\"\r\nimport CloseIcon from \"@material-ui/icons/Close\"\r\nimport HeightIcon from \"@material-ui/icons/Height\"\r\nimport EditIcon from \"@material-ui/icons/Edit\"\r\n\r\nimport { AppContext } from \"../../../App.js\"\r\nimport useSnapshots from \"../../../utils/useSnapshots.js\"\r\nimport { TEXTBOX_PADDING } from \"../../../config/constants.js\"\r\n\r\nconst useStyles = makeStyles(theme => {\r\n    const highlight = {\r\n        backgroundColor: \"rgba(255, 255, 255, .5)\",\r\n        border: \"1px solid black\",\r\n        borderRadius: theme.shape.borderRadius,\r\n        display: props => props.capture && \"none\"\r\n    }\r\n\r\n    const handle = {\r\n        ...highlight,\r\n        zIndex: 20,\r\n        height: 24,\r\n        position: \"absolute\",\r\n        cursor: \"pointer\"\r\n    }\r\n\r\n    return {\r\n        container: {\r\n            position: \"absolute\",\r\n            top: 0,\r\n            display: \"flex\",\r\n            flexDirection: \"column\",\r\n            alignItems: \"center\",\r\n            zIndex: 10\r\n        },\r\n\r\n        rotationHandle: {\r\n            ...highlight,\r\n            cursor: \"pointer\"\r\n        },\r\n\r\n        button: {\r\n            ...highlight,\r\n            padding: 0,\r\n            marginLeft: theme.spacing(1),\r\n            color: \"black\"\r\n        },\r\n\r\n        action: {\r\n            position: \"absolute\",\r\n            transform: \"translateY(-100%)\",\r\n            width: \"100%\",\r\n            display: \"flex\",\r\n            justifyContent: \"center\",\r\n            height: 24\r\n        },\r\n\r\n        resizeHandles: {\r\n            position: \"absolute\",\r\n            height: \"100%\",\r\n            width: \"100%\"\r\n        },\r\n\r\n        vertical: {\r\n            ...handle,\r\n            top: \"100%\",\r\n            left: \"50%\",\r\n            transform: \"translate(-50%, -50%)\",\r\n            cursor: \"ns-resize\"\r\n        },\r\n\r\n        horizontal: {\r\n            ...handle,\r\n            top: \"50%\",\r\n            left: \"100%\",\r\n            transform: \"translate(-50%, -50%) rotate(-90deg)\",\r\n            cursor: \"ew-resize\"\r\n        },\r\n\r\n        diagonal: {\r\n            ...handle,\r\n            top: \"100%\",\r\n            left: \"100%\",\r\n            transform: \"translate(-50%, -50%) rotate(-45deg)\",\r\n            cursor: \"nwse-resize\"\r\n        }\r\n    }\r\n})\r\n\r\nfunction makeElement({\r\n    controls,\r\n    defaultValues,\r\n    Child\r\n}) {\r\n    return function Element({ onRemove, handle, grid, canvas, template, id, ...props }) {\r\n        const context = useContext(AppContext)\r\n\r\n        const lastRotation = useRef(template?.rotation || 0)\r\n        const container = useRef()\r\n        const childRef = useRef()\r\n        const hasCreatedSnapshot = useRef(false)\r\n\r\n        const [position, setPosition] = useState({ x: template?.x || 0, y: template?.y || 0 })\r\n        const [rotation, setRotation] = useState(template?.rotation || 0)\r\n        const [height, setHeight] = useState((template?.height && template.height - TEXTBOX_PADDING * 2) || defaultValues.height)\r\n        const [width, setWidth] = useState((template?.width && template.width - TEXTBOX_PADDING * 2) || defaultValues.width)\r\n        const [capture, setCapture] = useState(false)\r\n        const [isFocused, setIsFocused] = useState(false)\r\n        const [shouldMove, setShouldMove] = useState(true)\r\n\r\n        const classes = useStyles({ capture })\r\n\r\n        // Set grid for movement drag\r\n        const dragGrid = useMemo(() => {\r\n            if (grid.enabled) {\r\n                if (grid.fixedSize) {\r\n                    // Fixed size\r\n                    return [grid.spacing, grid.spacing]\r\n                } else {\r\n                    // Relative size\r\n                    const cellWidth = canvas.clientWidth / grid.columns\r\n                    const cellHeight = canvas.clientHeight / grid.rows\r\n                    return [cellWidth, cellHeight]\r\n                }\r\n            }\r\n        }, [grid, context.image])\r\n\r\n        const addSnapshot = useSnapshots({\r\n            createSnapshot: () => ({ width, height, position, rotation }),\r\n\r\n            applySnapshot: (snapshot) => {\r\n                setWidth(snapshot.width)\r\n                setHeight(snapshot.height)\r\n                setPosition(snapshot.position)\r\n                setRotation(snapshot.rotation)\r\n            },\r\n\r\n            onSnapshotsEmpty: () => {\r\n                // Remove element if it does not come from template\r\n                if (!template) {\r\n                    onRemove(id)\r\n                }\r\n            }\r\n        })\r\n\r\n        const getRotationAngle = (event, data) => {\r\n            // Get child center position\r\n            const childRect = childRef.current.getBoundingClientRect()\r\n            const childCenter = {\r\n                x: childRect.x + childRect.width / 2,\r\n                y: childRect.y + childRect.height / 2\r\n            }\r\n\r\n            // Calculate new rotation\r\n            const childToMouse = Math.atan2(childCenter.y - data.y, childCenter.x - data.x)\r\n            let newRotation = childToMouse - lastRotation.current\r\n\r\n            // Snap to 45°\r\n            if (grid.enabled) {\r\n                newRotation -= newRotation % (Math.PI / 4)\r\n            }\r\n\r\n            return newRotation\r\n        }\r\n\r\n        const handleRotationStart = (event, data) => {\r\n            lastRotation.current = getRotationAngle(event, data)\r\n        }\r\n\r\n        const handleRotationEnd = (event, data) => {\r\n            lastRotation.current = getRotationAngle(event, data)\r\n        }\r\n\r\n        const handleRotationDrag = (event, data) => {\r\n            setRotation(getRotationAngle(event, data))\r\n        }\r\n            \r\n        const emitResize = () => {\r\n            if(handle.onResize) {\r\n                handle.onResize()\r\n            }\r\n        }\r\n\r\n        const calcNewHeight = (data) => {\r\n            // Calculate new delta-y with the following rotation matrix: https://en.wikipedia.org/wiki/Rotation_matrix\r\n            const angle = -rotation\r\n            const dy = data.deltaX * Math.sin(angle) + data.deltaY * Math.cos(angle)\r\n            const newHeight = height + dy\r\n            setHeight(newHeight)\r\n\r\n            if(handle.aspectRatio) {\r\n                const newWidth = newHeight * (1 / handle.aspectRatio)\r\n                setWidth(newWidth)\r\n            }\r\n        }\r\n\r\n        const calcNewWidth = (data) => {\r\n            // Calculate new delta-x with the following rotation matrix: https://en.wikipedia.org/wiki/Rotation_matrix\r\n            const angle = -rotation\r\n            const dx = data.deltaX * Math.cos(angle) - data.deltaY * Math.sin(angle)\r\n            const newWidth = width + dx\r\n            setWidth(width + dx)\r\n\r\n            if(handle.aspectRatio) {\r\n                const newHeight = newWidth * handle.aspectRatio\r\n                setHeight(newHeight)\r\n            }\r\n        }\r\n\r\n        const handleVerticalDrag = (event, data) => {\r\n            calcNewHeight(data)\r\n            emitResize()\r\n        }\r\n\r\n        const handleHorizontalDrag = (event, data) => {\r\n            calcNewWidth(data)\r\n            emitResize()\r\n        }\r\n\r\n        const handleDiagonalDrag = (event, data) => {\r\n            calcNewWidth(data)\r\n            calcNewHeight(data)\r\n            emitResize()\r\n        }\r\n\r\n        const handleMovementDrag = (event, data) => {\r\n            if(!isFocused) {\r\n                return\r\n            }\r\n\r\n            // Add snapshot when dragging starts\r\n            if(!hasCreatedSnapshot.current) {\r\n                addSnapshot()\r\n                hasCreatedSnapshot.current = true\r\n            }\r\n\r\n            setPosition({\r\n                x: position.x + data.deltaX,\r\n                y: position.y + data.deltaY\r\n            })\r\n        }\r\n\r\n        const handleMovementStop = () => {\r\n            hasCreatedSnapshot.current = false\r\n        }\r\n\r\n        const handleRemoveClicked = () => {\r\n            onRemove(id)\r\n        }\r\n\r\n        const handleFocus = () => {\r\n            setIsFocused(true)\r\n        }\r\n\r\n        const handleBlur = () => {\r\n            setIsFocused(false)\r\n        }\r\n\r\n        const handleToggleMovement = (state = true) => {\r\n            setShouldMove(state)\r\n        }\r\n\r\n        const beforeCapturing = () => {\r\n            setCapture(true)\r\n        }\r\n\r\n        const afterCapturing = () => {\r\n            setCapture(false)\r\n        }\r\n\r\n        // Expose methods to parent\r\n        if (handle) {\r\n            handle.beforeCapturing = beforeCapturing\r\n            handle.afterCapturing = afterCapturing\r\n        }\r\n\r\n        useEffect(() => {\r\n            if (grid.enabled) {\r\n                // Init position in grid\r\n                setPosition({\r\n                    x: position.x - position.x % dragGrid[0],\r\n                    y: position.y - position.y % dragGrid[1]\r\n                })\r\n\r\n                // Init width in grid\r\n                const newWidth = width - (width + TEXTBOX_PADDING * 2) % dragGrid[0]\r\n                setWidth(newWidth)\r\n\r\n                // Init height in grid\r\n                const newHeight = height - (height + TEXTBOX_PADDING * 2) % dragGrid[1]\r\n                setHeight(newHeight)\r\n            }\r\n        }, [grid])\r\n\r\n        useEffect(() => {\r\n            // Handle click-away event\r\n            const handleClick = (event) => {\r\n                if (isFocused && !container.current.contains(event.target)) {\r\n                    handleBlur()\r\n                }\r\n            }\r\n\r\n            window.addEventListener(\"click\", handleClick)\r\n            window.addEventListener(\"touchstart\", handleClick)\r\n            \r\n            return () => {\r\n                window.removeEventListener(\"click\", handleClick)\r\n                window.removeEventListener(\"touchstart\", handleClick)\r\n            }\r\n        })\r\n\r\n        useEffect(() => {\r\n            (async () => {\r\n                // Wait until handle received all props\r\n                await new Promise(requestAnimationFrame)\r\n\r\n                // Init dimensions\r\n                if (handle.aspectRatio) {\r\n                    if (width) {\r\n                        setHeight(width * handle.aspectRatio)\r\n                    } else if (height) {\r\n                        setWidth(height * (1 / handle.aspectRatio))\r\n                    }\r\n                }\r\n            })()\r\n        }, [])\r\n\r\n        return (\r\n            <DraggableCore onDrag={handleMovementDrag} onStop={handleMovementStop} grid={dragGrid} handle={`#element-${id}`} disabled={!shouldMove}>\r\n                <div\r\n                    className={`${classes.container} element`}\r\n                    style={{\r\n                        transform: `translate(${position.x}px, ${position.y}px) rotate(${rotation}rad)`,\r\n                        transformOrigin: `center center`,\r\n                        zIndex: defaultValues.zIndex || 0\r\n                    }}\r\n                    ref={container}\r\n                    data-id={id}\r\n                >\r\n                    <Child\r\n                        id={id}\r\n                        handle={handle}\r\n                        template={template}\r\n                        onFocus={handleFocus}\r\n                        isFocused={isFocused}\r\n                        toggleMovement={handleToggleMovement}\r\n                        dimensions={{ width, height, ...position, rotation }}\r\n                        ref={childRef}\r\n                        capture={capture}\r\n                        {...props}\r\n                    />\r\n\r\n                    {isFocused && (\r\n                        // Render controls if the element is focused\r\n                        <>\r\n                            {controls.includes(\"resize\") && (\r\n                                <div className={classes.resizeHandles}>\r\n                                    <DraggableCore onDrag={handleVerticalDrag} onStart={addSnapshot} grid={dragGrid}>\r\n                                        <div className={classes.vertical}>\r\n                                            <HeightIcon />\r\n                                        </div>\r\n                                    </DraggableCore>\r\n\r\n                                    <DraggableCore onDrag={handleHorizontalDrag} onStart={addSnapshot} grid={dragGrid}>\r\n                                        <div className={classes.horizontal}>\r\n                                            <HeightIcon />\r\n                                        </div>\r\n                                    </DraggableCore>\r\n\r\n                                    <DraggableCore onDrag={handleDiagonalDrag} onStart={addSnapshot} grid={dragGrid}>\r\n                                        <div className={classes.diagonal}>\r\n                                            <HeightIcon />\r\n                                        </div>\r\n                                    </DraggableCore>\r\n                                </div>\r\n                            )}\r\n\r\n                            <div className={classes.action}>\r\n                                {controls.includes(\"rotate\") && (\r\n                                    <DraggableCore onStart={(...args) => {\r\n                                        handleRotationStart(...args)\r\n                                        addSnapshot()\r\n                                    }} onStop={handleRotationEnd} onDrag={handleRotationDrag}>\r\n                                        <RotateLeftIcon className={classes.rotationHandle} />\r\n                                    </DraggableCore>\r\n                                )}\r\n\r\n                                {controls.includes(\"edit\") && (\r\n                                    <IconButton className={classes.button} onClick={handle.onEditClicked}>\r\n                                        <EditIcon />\r\n                                    </IconButton>\r\n                                )}\r\n\r\n                                {controls.includes(\"settings\") && (\r\n                                    <IconButton className={classes.button} onClick={handle.onSettingsClicked}>\r\n                                        <SettingsIcon />\r\n                                    </IconButton>\r\n                                )}\r\n\r\n                                {controls.includes(\"remove\") && (\r\n                                    <IconButton className={classes.button} onClick={handleRemoveClicked}>\r\n                                        <CloseIcon />\r\n                                    </IconButton>\r\n                                )}\r\n                            </div>\r\n                        </>\r\n                    )}\r\n                </div>\r\n            </DraggableCore>\r\n        )\r\n    }\r\n}\r\n\r\nexport default makeElement","import textfit from \"textfit\"\r\n\r\nfunction getNewFontsize(div) {\r\n    textfit(div, {\r\n        multiLine: true,\r\n        minFontSize: 1,\r\n        maxFontSize: window.innerHeight\r\n    })\r\n    const span = div.querySelector(\"span\")\r\n    const fontSize = getComputedStyle(span).fontSize\r\n    return parseInt(fontSize)\r\n}\r\n\r\nfunction fitText({ width, height, text, styles }) {\r\n    width = Math.floor(width)\r\n    height = Math.floor(height)\r\n\r\n    if(width <= 0 || height <= 0) {\r\n        return 0\r\n    }\r\n\r\n    const div = document.createElement(\"div\")\r\n\r\n    // div.style.visibility = \"hidden\"\r\n    div.style.position = \"absolute\"\r\n    div.style.width = width + \"px\"\r\n    div.style.height = height + \"px\"\r\n    div.style.whiteSpace = \"pre-wrap\"\r\n    div.style.fontWeight = styles.bold ? \"bold\" : null\r\n    div.style.textTransform = styles.caps ? \"uppercase\" : null\r\n\r\n    Object.assign(div.style, styles)\r\n\r\n    div.textContent = text\r\n\r\n    document.body.appendChild(div)\r\n\r\n    const fontSize = getNewFontsize(div)\r\n\r\n    document.body.removeChild(div)\r\n\r\n    return fontSize\r\n}\r\n\r\nexport default fitText","import React, { useState, useRef, useMemo, useEffect } from \"react\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\n\r\nimport TextboxSettingsDialog from \"../../Dialogs/TextboxSettingsDialog.js\"\r\n\r\nimport useSnapshots from \"../../../utils/useSnapshots.js\"\r\nimport makeElement from \"./makeElement.js\"\r\nimport fitText from \"../../../utils/fitText.js\"\r\nimport { TEXTBOX_PLACEHOLDER, TEXTBOX_PADDING } from \"../../../config/constants.js\"\r\n\r\nconst globalDefaultSettings = {\r\n    color: \"black\",\r\n    textAlign: \"center\",\r\n    fontFamily: \"'Impact', fantasy\",\r\n    backgroundColor: \"transparent\",\r\n    verticalTextAlign: \"center\",\r\n    bold: false,\r\n    caps: true\r\n}\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    input: {\r\n        background: \"none\",\r\n        border: \"none\",\r\n        outline: props => !props.capture && props.isFocused ? \"1px dashed gray\" : \"none\",\r\n        fontSize: 24,\r\n        color: \"white\",\r\n        fontFamily: theme.typography.fontFamily,\r\n        textTransform: props => props.settings.caps && \"uppercase\",\r\n        resize: \"none\",\r\n        whiteSpace: \"pre-wrap\",\r\n        zIndex: 10,\r\n        padding: TEXTBOX_PADDING,\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        fontWeight: props => props.settings.bold && \"bold\",\r\n        userSelect: props => !props.isEditing && \"none\",\r\n        cursor: props => !props.isEditing && \"move\",\r\n        justifyContent: props => (\r\n            props.settings.verticalTextAlign === \"top\" ? \"flex-start\" :\r\n            props.settings.verticalTextAlign === \"bottom\" ? \"flex-end\" :\r\n            props.settings.verticalTextAlign === \"center\" ? \"center\" :\r\n            null\r\n        )\r\n    }\r\n}))\r\n\r\nfunction Textbox({ id, handle, template, onFocus, isFocused, toggleMovement, dimensions }, forwardedRef) {\r\n    const defaultSettings = {...globalDefaultSettings}\r\n\r\n    // Apply template settings\r\n    if(template?.settings) {\r\n        for(let key in defaultSettings) {\r\n            if(template.settings[key]) {\r\n                defaultSettings[key] = template.settings[key]\r\n            }\r\n        }\r\n    }\r\n\r\n    const textboxRef = useRef()\r\n    const shouldEmitSnapshot = useRef(false)\r\n\r\n    const [value, setValue] = useState(TEXTBOX_PLACEHOLDER)\r\n    const [dialogOpen, setDialogOpen] = useState(false)\r\n    const [settings, setSettings] = useState(defaultSettings)\r\n    const [isEditing, setIsEditing] = useState(false)\r\n\r\n    const classes = useStyles({ settings, isFocused, isEditing }) \r\n\r\n    const addSnapshot = useSnapshots({\r\n        createSnapshot: () => ({ value, settings }),\r\n\r\n        applySnapshot: (snapshot) => {\r\n            setValue(snapshot.value)\r\n            textboxRef.current.textContent = snapshot.value\r\n            setSettings(snapshot.settings)\r\n        },\r\n\r\n        onSnapshotsEmpty: () => {\r\n            // Set initial values\r\n            setValue(TEXTBOX_PLACEHOLDER)\r\n            setSettings(defaultSettings)\r\n        }\r\n    })\r\n\r\n    const handleSettingsClicked = () => {\r\n        setDialogOpen(true)\r\n    }\r\n\r\n    const handleSettingsApply = values => {\r\n        if(values) {\r\n            addSnapshot()\r\n            setSettings(values)\r\n        }\r\n        setDialogOpen(false)\r\n    }\r\n    \r\n    const handleEditClicked = async () => {\r\n        const handleFocusOut = () => {\r\n            toggleMovement(true)\r\n            setIsEditing(false)\r\n            textboxRef.current.removeEventListener(\"focusout\", handleFocusOut)\r\n        }\r\n        \r\n        shouldEmitSnapshot.current = true\r\n        toggleMovement(false)\r\n        setIsEditing(true)\r\n        textboxRef.current.addEventListener(\"focusout\", handleFocusOut)\r\n\r\n        // Wait until contenteditable is set\r\n        await new Promise(requestAnimationFrame)\r\n\r\n        textboxRef.current.focus()\r\n\r\n        // Clear the placeholder\r\n        if(value.toLowerCase() === TEXTBOX_PLACEHOLDER.toLowerCase()) {\r\n            textboxRef.current.textContent = \"\"\r\n        }\r\n    }\r\n\r\n    const handleValueChange = (event) => {\r\n        if(shouldEmitSnapshot.current) {\r\n            shouldEmitSnapshot.current = false\r\n            addSnapshot()\r\n        }\r\n\r\n        const newValue = event.target.textContent\r\n        setValue(newValue)\r\n    }\r\n\r\n    const toObject = ({ image }) => {\r\n        const toPercentage = (value, useWidth = false) => value / (useWidth ? image.clientWidth : image.clientHeight) * 100 + \"%\"\r\n\r\n        const changedSettings = {}\r\n        for(let key in settings) {\r\n            if(settings[key] !== defaultSettings[key]) {\r\n                changedSettings[key] = settings[key]\r\n            }\r\n        }\r\n\r\n        return {\r\n            value,\r\n            width: toPercentage(dimensions.width + TEXTBOX_PADDING * 2, true),\r\n            height: toPercentage(dimensions.height + TEXTBOX_PADDING * 2),\r\n            x: toPercentage(dimensions.x, true),\r\n            y: toPercentage(dimensions.y),\r\n            rotation: dimensions.rotation,\r\n            settings: changedSettings\r\n        }\r\n    }\r\n\r\n    // Expose methods for parent\r\n    if(handle) {\r\n        handle.toObject = toObject\r\n        handle.onEditClicked = handleEditClicked\r\n        handle.onSettingsClicked = handleSettingsClicked\r\n    }\r\n\r\n    // Generate stylings for textbox\r\n    const styles = useMemo(() => ({\r\n        ...settings,\r\n        width: dimensions.width + \"px\",\r\n        height: dimensions.height + \"px\",\r\n        fontSize: fitText({ styles: settings, text: value, ...dimensions })\r\n    }), [value, settings, dimensions.width, dimensions.height])\r\n\r\n    useEffect(() => {\r\n        // Set initial value\r\n        textboxRef.current.textContent = value\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        if(!isEditing && !value) {\r\n            // Insert placeholder if textbox is empty\r\n            setValue(TEXTBOX_PLACEHOLDER)\r\n            textboxRef.current.textContent = TEXTBOX_PLACEHOLDER\r\n        }\r\n    }, [isEditing])\r\n    \r\n    return (\r\n        <>\r\n            <div\r\n                contentEditable={isEditing}\r\n                id={`element-${id}`}\r\n                className={`textbox ${classes.input}`}\r\n                style={styles}\r\n                ref={ref => {\r\n                    textboxRef.current = ref\r\n                    forwardedRef.current = ref\r\n                }}\r\n                onMouseDown={onFocus}\r\n                onTouchStart={onFocus}\r\n                onInput={handleValueChange}\r\n            />\r\n\r\n            <TextboxSettingsDialog open={dialogOpen} onClose={handleSettingsApply} values={settings} text={value}/>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default makeElement({\r\n    controls: [\"resize\", \"rotate\", \"edit\", \"settings\", \"remove\"],\r\n    defaultValues: {\r\n        width: 160,\r\n        height: 24,\r\n        zIndex: 2\r\n    },\r\n    Child: React.forwardRef(Textbox)\r\n})","import React, { useEffect } from \"react\"\r\nimport { useForm, FormContext } from \"react-hook-form\"\r\nimport { Dialog, Button } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\n\r\nimport Switch from \"./components/Switch.js\"\r\n\r\nimport withBackButtonSupport from \"../../utils/withBackButtonSupport.js\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    form: {\r\n        padding: theme.spacing(2),\r\n        paddingTop: 0\r\n    },\r\n\r\n    applyButton: {\r\n        marginTop: theme.spacing(2)\r\n    },\r\n\r\n    input: {\r\n        marginTop: theme.spacing(1)\r\n    },\r\n\r\n    image: {\r\n        width: 100\r\n    },\r\n\r\n    imageWrapper: {\r\n        width: \"100%\",\r\n        textAlign: \"center\",\r\n        padding: theme.spacing(1),\r\n        boxSizing: \"border-box\"\r\n    }\r\n}))\r\n\r\nfunction ImageSettingsDialog({ onClose, open, values, src }) {\r\n    const { getValues, handleSubmit, control, watch, reset, register, setValue } = useForm()\r\n\r\n\r\n    const classes = useStyles()\r\n\r\n    const handleClose = () => {\r\n        onClose(getValues())\r\n    }\r\n\r\n    useEffect(() => {\r\n        reset(values)\r\n    }, [values, reset])\r\n\r\n    return (\r\n        <Dialog onClose={handleClose} open={open}>\r\n            <div className={classes.imageWrapper}>\r\n                <img src={src} alt=\"\" className={classes.image} style={{\r\n                    transform: `scaleX(${watch(\"flip\") ? \"-1\" : \"1\"})`\r\n                }}/>\r\n            </div>\r\n\r\n            <FormContext {...{ control, watch, register, setValue }}>\r\n                <form onSubmit={handleSubmit(handleClose)} className={classes.form}>\r\n                    {/* Keep Aspect Ratio */}\r\n                    <Switch name=\"keepAspectRatio\" label=\"Keep Aspect Ratio\" className={classes.input} />\r\n\r\n                    {/* Flip */}\r\n                    <Switch name=\"flip\" label=\"Flip\" className={classes.input} />\r\n\r\n                    <Button fullWidth className={classes.applyButton} type=\"submit\">Apply</Button>\r\n                </form>\r\n            </FormContext>\r\n        </Dialog>\r\n    )\r\n}\r\n\r\nexport default withBackButtonSupport(ImageSettingsDialog, \"settings\")","import React, { useState, useRef } from \"react\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\n\r\nimport ImageSettingsDialog from \"../../Dialogs/ImageSettingsDialog.js\"\r\n\r\nimport makeElement from \"./makeElement.js\"\r\n\r\nconst defaultSettings = {\r\n    keepAspectRatio: true,\r\n    flip: false\r\n}\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    image: {\r\n        zIndex: 1,\r\n        cursor: \"move\"\r\n    }\r\n}))\r\n\r\nfunction Sticker({ src, id, onFocus, dimensions, handle }, forwardedRef) {\r\n    const classes = useStyles()\r\n\r\n    const imageRef = useRef()\r\n\r\n    const [settings, setSettings] = useState(defaultSettings)\r\n    const [isDialogOpen, setIsDialogOpen] = useState(false)\r\n\r\n    const handleSettingsApply = (values) => {\r\n        if(values) {\r\n            setSettings(values)\r\n        }\r\n        setIsDialogOpen(false)\r\n    }\r\n\r\n    const styles = {\r\n        width: dimensions.width + \"px\",\r\n        height: dimensions.height + \"px\",\r\n        transform: `scaleX(${settings.flip ? \"-1\" : \"1\"})`\r\n    }\r\n\r\n    if(handle) {\r\n        handle.onSettingsClicked = () => setIsDialogOpen(true)\r\n\r\n        if(settings.keepAspectRatio) {\r\n            Object.defineProperty(handle, \"aspectRatio\", { \r\n                get: function() {\r\n                    return imageRef.current?.naturalHeight / imageRef.current?.naturalWidth\r\n                },\r\n                configurable: true\r\n            })\r\n        } else {\r\n            delete handle.aspectRatio\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <img\r\n                src={src}\r\n                alt=\"\"\r\n                id={`element-${id}`}\r\n                ref={ref => {\r\n                    forwardedRef.current = ref\r\n                    imageRef.current = ref\r\n                }}\r\n                onMouseDown={onFocus}\r\n                onTouchStart={onFocus}\r\n                style={styles}\r\n                className={classes.image}\r\n                draggable=\"false\"\r\n            />\r\n\r\n            <ImageSettingsDialog open={isDialogOpen} onClose={handleSettingsApply} values={settings} src={src}/>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default makeElement({\r\n    controls: [\"resize\", \"rotate\", \"remove\", \"settings\"],\r\n    defaultValues: {\r\n        width: 100,\r\n        zIndex: 1\r\n    },\r\n    Child: React.forwardRef(Sticker)\r\n})","import React, { useEffect, useRef, useContext } from \"react\"\r\nimport { makeStyles } from \"@material-ui/core\"\r\n\r\nimport { AppContext } from \"../../App.js\"\r\n\r\nfunction line(context, x1, y1, x2, y2) {\r\n    context.beginPath()\r\n    context.moveTo(x1, y1)\r\n    context.lineTo(x2, y2)\r\n    context.stroke()\r\n}\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    canvas: {\r\n        position: \"absolute\",\r\n        pointerEvents: \"none\",\r\n        touchAction: \"none\"\r\n    }\r\n}))\r\n\r\nfunction Grid({ config, canvas, border }) {\r\n    const classes = useStyles()\r\n\r\n    const context = useContext(AppContext)\r\n\r\n    const grid = useRef()\r\n\r\n    let renderContext;\r\n\r\n    const setDimensions = async () => {\r\n        // Wait until canvas has resized proberly\r\n        await new Promise(requestAnimationFrame)\r\n\r\n        const canvasRect = canvas.getBoundingClientRect()\r\n\r\n        grid.current.width = canvasRect.width\r\n        grid.current.height = canvasRect.height\r\n    }\r\n\r\n    const render = (cellWidth, cellHeight) => {\r\n        for (let x = 0; x < grid.current.width; x += cellWidth) {\r\n            line(renderContext, x, 0, x, grid.current.height)\r\n        }\r\n\r\n        for (let y = 0; y < grid.current.height; y += cellHeight) {\r\n            line(renderContext, 0, y, grid.current.width, y)\r\n        }\r\n    }\r\n\r\n    // Render a dynamic amount of columns / rows with a fixed size\r\n    const renderWithFixedSpacing = () => {\r\n        if(!config.spacing) {\r\n            return\r\n        }\r\n\r\n        render(config.spacing, config.spacing)\r\n    }\r\n\r\n    // Render a fixed amount of columns / rows with a dynamic size\r\n    const renderWithRelativeSpacing = () => {\r\n        if(!config.columns || !config.rows || !canvas) {\r\n            return\r\n        }\r\n\r\n        const cellWidth = canvas.clientWidth / config.columns\r\n        const cellHeight = canvas.clientHeight / config.rows\r\n\r\n        render(cellWidth, cellHeight)\r\n    }\r\n\r\n    const renderGrid = () => {\r\n        renderContext = grid.current.getContext(\"2d\")\r\n\r\n        renderContext.strokeStyle = config.color\r\n\r\n        if(config.fixedSpacing) {\r\n            renderWithFixedSpacing()\r\n        } else {\r\n            renderWithRelativeSpacing()\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        if(!canvas) {\r\n            return\r\n        }\r\n\r\n        setDimensions().then(renderGrid)\r\n    }, [canvas, config, context.image, border])\r\n\r\n    return (\r\n        <canvas\r\n            ref={grid}\r\n            style={{ display: !config.enabled && \"none\" }}\r\n            className={classes.canvas}\r\n        />\r\n    )\r\n}\r\n\r\nexport default Grid","import React, { useEffect } from \"react\"\r\nimport { Dialog, DialogTitle, Button, TextField, FormControlLabel, FormGroup } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport { useForm, FormContext } from \"react-hook-form\"\r\n\r\nimport Select from \"./components/Select.js\"\r\nimport Switch from \"./components/Switch.js\"\r\n\r\nimport settingsOptions from \"../../config/settings-options.json\"\r\nimport withBackButtonSupport from \"../../utils/withBackButtonSupport.js\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    form: {\r\n        padding: theme.spacing(2),\r\n        paddingTop: 0\r\n    },\r\n\r\n    applyButton: {\r\n        marginTop: theme.spacing(2)\r\n    },\r\n\r\n    input: {\r\n        marginTop: theme.spacing(1)\r\n    }\r\n}))\r\n\r\nfunction BorderDialog({ onClose, open, values }) {\r\n    const { register, getValues, handleSubmit, control, watch, reset, setValue } = useForm()\r\n\r\n    const classes = useStyles()\r\n\r\n    const handleClose = () => {\r\n        const values = getValues()\r\n\r\n        onClose(values)\r\n    }\r\n\r\n    useEffect(() => {\r\n        reset(values)\r\n    }, [values, reset])\r\n\r\n    return (\r\n        <Dialog onClose={handleClose} open={open}>\r\n                <DialogTitle>Set Border</DialogTitle>\r\n\r\n                <FormContext {...{ control, watch, register, setValue }}>\r\n                    <form onSubmit={handleSubmit(handleClose)} className={classes.form}>\r\n                        <FormGroup>\r\n                            {/* Size */}\r\n                            <TextField\r\n                                inputRef={register()}\r\n                                className={classes.input}\r\n                                fullWidth\r\n                                type=\"number\"\r\n                                name=\"size\"\r\n                                label=\"Size (px)\"\r\n                            />\r\n\r\n                            {/* Color */}\r\n                            <Select\r\n                                name=\"color\"\r\n                                label=\"Color\"\r\n                                options={settingsOptions.colors}\r\n                                className={classes.input}\r\n                                child={({ label, value }) => (\r\n                                    <span style={{ color: value }}>{label}</span>\r\n                                )}\r\n                            />\r\n\r\n                            {/* Top */}\r\n                            <Switch name=\"top\" label=\"Top\" className={classes.input}/>\r\n\r\n                            {/* Bottom */}\r\n                            <Switch name=\"bottom\" label=\"Bottom\" className={classes.input}/>\r\n\r\n                            {/* Left */}\r\n                            <Switch name=\"left\" label=\"Left\" className={classes.input}/>\r\n\r\n                            {/* Right */}\r\n                            <Switch name=\"right\" label=\"Right\" className={classes.input}/>\r\n\r\n                            <Button fullWidth className={classes.applyButton} type=\"submit\">Apply</Button>\r\n                        </FormGroup>\r\n                    </form>\r\n                </FormContext>\r\n        </Dialog>\r\n    )\r\n}\r\n\r\nexport default withBackButtonSupport(BorderDialog, \"border\")","import React, { useContext } from \"react\"\r\nimport { SwipeableDrawer, IconButton, DialogTitle } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\n\r\nimport { AppContext } from \"../../App.js\"\r\n\r\nimport WhatsAppIcon from \"../../assets/images/icons/WhatsApp.svg\"\r\nimport TwitterIcon from \"../../assets/images/icons/Twitter.png\"\r\nimport FacebookIcon from \"../../assets/images/icons/Facebook.png\"\r\nimport GmailIcon from \"../../assets/images/icons/Gmail.png\"\r\nimport TelegramIcon from \"../../assets/images/icons/Telegram.png\"\r\nimport PinterestIcon from \"../../assets/images/icons/Pinterest.png\"\r\nimport RedditIcon from \"../../assets/images/icons/Reddit.png\"\r\nimport TumblrIcon from \"../../assets/images/icons/Tumblr.png\"\r\nimport SkypeIcon from \"../../assets/images/icons/Skype.png\"\r\nimport FBMessengerIcon from \"../../assets/images/icons/FBMessenger.png\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    innerDrawer: {\r\n        borderRadius: \"16px 16px 0 0\"\r\n    },\r\n\r\n    title: {\r\n        paddingBottom: theme.spacing(1)\r\n    },\r\n\r\n    iconsContainer: {\r\n        display: \"flex\",\r\n        padding: `0 ${theme.spacing(1)}px ${theme.spacing(2)}px ${theme.spacing(1)}px`,\r\n        overflowX: \"scroll\"\r\n    },\r\n\r\n    icon: {\r\n        width: 40\r\n    }\r\n}))\r\n\r\nfunction ShareDialog({ open, link, onClose, onOpen }) {\r\n    link = encodeURIComponent(link)\r\n\r\n    const context = useContext(AppContext)\r\n    \r\n    const classes = useStyles()\r\n\r\n    const openLink = (href, label) => () => {\r\n        context.event.dispatchEvent(new CustomEvent(\"share\", { detail: { label } }))\r\n        window.open(href.replace(/{}/g, link))\r\n    }\r\n\r\n    return (\r\n        <SwipeableDrawer\r\n            disableDiscovery\r\n            disableSwipeToOpen\r\n            open={open}\r\n            onClose={onClose}\r\n            onOpen={onOpen}\r\n            anchor=\"bottom\"\r\n            PaperProps={{ className: classes.innerDrawer }}\r\n        >\r\n            <DialogTitle className={classes.title}>Share Link</DialogTitle>\r\n\r\n            <div className={classes.iconsContainer}>\r\n                <IconButton onClick={openLink(\"whatsapp://send?text={}\", \"WhatsApp\")}>\r\n                    <img src={WhatsAppIcon} alt=\"WhatsApp\" className={classes.icon}/>\r\n                </IconButton>\r\n\r\n                <IconButton onClick={openLink(\"https://www.facebook.com/sharer/sharer.php?u={}\", \"Facebook\")}>\r\n                    <img src={FacebookIcon} alt=\"Facebook\" className={classes.icon}/>\r\n                </IconButton>\r\n\r\n                <IconButton onClick={openLink(\"http://twitter.com/intent/tweet?text={}\", \"Twitter\")}>\r\n                    <img src={TwitterIcon} alt=\"Twitter\" className={classes.icon}/>\r\n                </IconButton>\r\n\r\n                <IconButton onClick={openLink(\"https://telegram.me/share?url={}\", \"Telegram\")}>\r\n                    <img src={TelegramIcon} alt=\"Telegram\" className={classes.icon}/>\r\n                </IconButton>\r\n\r\n                <IconButton onClick={openLink(\"https://web.skype.com/share?url={}\", \"Skype\")}>\r\n                    <img src={SkypeIcon} alt=\"Skype\" className={classes.icon}/>\r\n                </IconButton>\r\n\r\n                <IconButton onClick={openLink(\"fb-messenger://share?link={}\", \"FB-Messenger\")}>\r\n                    <img src={FBMessengerIcon} alt=\"Messenger\" className={classes.icon}/>\r\n                </IconButton>\r\n\r\n                <IconButton onClick={openLink(\"https://www.pinterest.com/pin/create/button?url={}\", \"Pinterest\")}>\r\n                    <img src={PinterestIcon} alt=\"Pinterest\" className={classes.icon}/>\r\n                </IconButton>\r\n\r\n                <IconButton onClick={openLink(\"https://www.reddit.com/submit?url={}\", \"Reddit\")}>\r\n                    <img src={RedditIcon} alt=\"Reddit\" className={classes.icon}/>\r\n                </IconButton>\r\n\r\n                <IconButton onClick={openLink(\"https://www.tumblr.com/widgets/share/tool?posttype=link&canonicalUrl={}\", \"Tumblr\")}>\r\n                    <img src={TumblrIcon} alt=\"Tumblr\" className={classes.icon}/>\r\n                </IconButton>\r\n\r\n                <IconButton onClick={openLink(\"mailto:?body={}\", \"Mail\")}>\r\n                    <img src={GmailIcon} alt=\"Email\" className={classes.icon}/>\r\n                </IconButton>\r\n            </div>\r\n        </SwipeableDrawer>\r\n    )\r\n}\r\n\r\nexport default ShareDialog","function dataURLtoFile(dataurl, filename) {\r\n    var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],\r\n        bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);\r\n    while (n--) {\r\n        u8arr[n] = bstr.charCodeAt(n);\r\n    }\r\n    return new File([u8arr], filename, { type: mime });\r\n}\r\n\r\nexport default dataURLtoFile","import { IS_DEV, CACHE_NAME } from \"../config/constants.js\"\r\n\r\nconst isCacheSupported = \"caches\" in window\r\n\r\nexport async function cachedRequest(url) {\r\n    // Do not cache in development mode\r\n    if (IS_DEV || !isCacheSupported) {\r\n        return await fetch(url)\r\n    }\r\n\r\n    // Retrieve cache instance\r\n    const cache = await caches.open(CACHE_NAME)\r\n\r\n    // Get cached data\r\n    const cachedData = await cache.match(url)\r\n\r\n    // Return cached data if neccessary\r\n    if(!navigator.onLine) {\r\n        return cachedData\r\n    }\r\n\r\n    // Request data from url\r\n    const response = await fetch(url)\r\n\r\n    // Write data to cache\r\n    cache.put(url, response.clone())\r\n\r\n    return response\r\n}\r\n\r\nexport async function getCachedImage(url) {\r\n    if (!isCacheSupported) {\r\n        return url\r\n    }\r\n\r\n    // Retrieve cache instance\r\n    const cache = await caches.open(CACHE_NAME)\r\n\r\n    // Get cached response\r\n    const response = await cache.match(url)\r\n\r\n    // Return url if image is not cached\r\n    if(!response) {\r\n        return url\r\n    }\r\n\r\n    // Create local image url from response\r\n    const blob = await response.blob()\r\n    const imageURL = URL.createObjectURL(blob)\r\n    \r\n    return imageURL\r\n}\r\n\r\nexport async function cacheImage(url) {\r\n    if (!isCacheSupported) {\r\n        return\r\n    }\r\n\r\n    // Do not cache blob / in development mode\r\n    if(url.indexOf(\"blob\") === 0 || IS_DEV) {\r\n        return\r\n    }\r\n\r\n    // Retrieve cache instance\r\n    const cache = await caches.open(CACHE_NAME)\r\n\r\n    // Check if image is cached already\r\n    const cachedData = await cache.match(url)\r\n\r\n    if(!cachedData) {\r\n        // Store image in cache\r\n        const response = await fetch(url)\r\n        cache.put(url, response)\r\n    }\r\n}","import { IS_DEV } from \"../config/constants.js\"\r\nimport { cachedRequest, getCachedImage } from \"./cache.js\"\r\n\r\nfunction url(path) {\r\n    return `${window.location.protocol}//${window.location.hostname}${IS_DEV ? \":8080\" : \"\"}/api${path}`\r\n}\r\n\r\n// Templates\r\n\r\nexport const uploadTemplate = (formData) => fetch(url(\"/templates\"), {\r\n    method: \"POST\",\r\n    body: formData\r\n})\r\n\r\nexport const getTemplates = () => {\r\n    return cachedRequest(url(\"/templates\"))\r\n        .then(res => res.json())\r\n        .then(async data => {\r\n            for(let template of data) {\r\n                template.image_url = await getCachedImage(template.image_url)\r\n\r\n                if (template.meta_data) {\r\n                    template.meta_data = JSON.parse(template.meta_data)\r\n                }\r\n            }\r\n\r\n            return data\r\n        })\r\n}\r\n\r\nexport const deleteTemplate = (password, id) => fetch(url(\"/templates/delete/\" + id), {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({ password })\r\n})\r\n\r\nexport const registerTemplateUse = (id) => fetch(url(\"/templates/register-use\"), {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({ id })\r\n})\r\n\r\n// Auth\r\n\r\nexport const authorize = (password) => fetch(url(\"/auth/authorize\"), {\r\n    method: \"POST\",\r\n    headers: {\r\n        \"Content-Type\": \"application/json\"\r\n    },\r\n    body: JSON.stringify({ password })\r\n}).then(res => res.json())\r\n\r\n// Stickers\r\n\r\nexport const getStickers = () => cachedRequest(url(\"/stickers\"))\r\n    .then(res => res.json())\r\n    .then(async data => {\r\n        for(let sticker of data) {\r\n            sticker.image_url = await getCachedImage(sticker.image_url)\r\n        }\r\n\r\n        return data\r\n    })\r\n\r\nexport const uploadSticker = (formData) => fetch(url(\"/stickers\"), {\r\n    method: \"POST\",\r\n    body: formData\r\n})\r\n\r\nexport const deleteSticker = (password, id) => fetch(url(\"/stickers/delete/\" + id), {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({ password })\r\n})\r\n\r\nexport const registerStickerUse = (id) => fetch(url(\"/stickers/register-use\"), {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({ id })\r\n})\r\n\r\n// Upload\r\n\r\nexport const uploadFile = (formData) => fetch(\"/upload\", {\r\n    method: \"POST\",\r\n    body: formData\r\n})","import { uploadFile } from \"./API.js\"\r\n\r\nasync function uploadImage(image) {\r\n    // Create formData object\r\n    const formData = new FormData()\r\n    formData.append(\"file\", image)\r\n\r\n    // Upload image to server\r\n    try {\r\n        const res = await uploadFile(formData)\r\n        \r\n        const data = await res.json()\r\n    \r\n        return \"https://\" + window.location.host + data.path\r\n    } catch (error) {\r\n        console.error(error)\r\n        return\r\n    }\r\n}\r\n\r\nexport default uploadImage","import React, { useState, useEffect, useContext, useRef } from \"react\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { Dialog, Button, CircularProgress, Paper, Typography, IconButton, TextField, Snackbar } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport DownloadIcon from \"@material-ui/icons/GetApp\"\r\nimport LinkIcon from \"@material-ui/icons/Link\"\r\nimport ShareIcon from \"@material-ui/icons/Share\"\r\nimport PublishIcon from \"@material-ui/icons/Publish\"\r\nimport CloseIcon from \"@material-ui/icons/Close\"\r\n\r\nimport ShareDialog from \"./ShareDialog.js\"\r\n\r\nimport { AppContext } from \"../../App.js\"\r\nimport downloadImageFromSrc from \"../../utils/downloadImageFromSrc.js\"\r\nimport dataURLToFile from \"../../utils/dataURLToFile.js\"\r\nimport uploadImage from \"../../utils/uploadImage.js\"\r\nimport withBackButtonSupport from \"../../utils/withBackButtonSupport.js\"\r\nimport { uploadTemplate, registerTemplateUse, registerStickerUse } from \"../../utils/API.js\"\r\nimport { IS_ANDROID_APP } from \"../../config/constants.js\"\r\n\r\nconst useStyles = makeStyles(theme => {\r\n    const button = {\r\n        margin: theme.spacing(2),\r\n        marginTop: 0\r\n    }\r\n\r\n    return {\r\n        button,\r\n\r\n        title: {\r\n            textAlign: \"center\"\r\n        },\r\n\r\n        innerDialog: {\r\n            margin: theme.spacing(1),\r\n            width: props => !props.imageData && \"100%\",\r\n            height: props => !props.imageData && \"50%\",\r\n            display: props => !props.imageData && \"flex\",\r\n            justifyContent: props => !props.imageData && \"center\",\r\n            alignItems: props => !props.imageData && \"center\"\r\n        },\r\n\r\n        image: {\r\n            width: \"90%\",\r\n            margin: `${theme.spacing(2)}px auto`\r\n        },\r\n\r\n        uploadButtonWrapper: {\r\n            ...button,\r\n            position: \"relative\"\r\n        },\r\n        \r\n        buttonLoader: {\r\n            position: \"absolute\",\r\n            top: \"50%\", left: \"50%\",\r\n            margin: \"-12px 0 0 -12px\"\r\n        },\r\n\r\n        linkWrapper: {\r\n            margin: theme.spacing(2),\r\n            marginTop: 0,\r\n            padding: `0 ${theme.spacing(1)}px`,\r\n            display: \"flex\",\r\n            justifyContent: \"space-between\",\r\n            alignItems: \"center\"\r\n        },\r\n\r\n        link: {\r\n            overflowX: \"scroll\",\r\n            padding: `${theme.spacing(1)}px 0`\r\n        },\r\n\r\n        shareButton: {\r\n            padding: theme.spacing(1)\r\n        },\r\n\r\n        snackbarClose: {\r\n            color: theme.palette.primary.variant\r\n        }\r\n    }\r\n})\r\n\r\nfunction ImageDialog({ open, onClose, imageData, elements }) {\r\n    const context = useContext(AppContext)\r\n\r\n    const { register, getValues } = useForm()\r\n\r\n    const classes = useStyles({ imageData })\r\n\r\n    // Increase the usage-counter only once\r\n    const isRegistered = useRef(false)\r\n\r\n    const [link, setLink] = useState()\r\n    const [isUploading, setIsUploading] = useState(false)\r\n    const [isShareDialogOpen, setIsShareDialogOpen] = useState(false)\r\n    const [isUploadSnackbarOpen, setIsUploadSnackbarOpen] = useState(false)\r\n    const [hasCreatedTemplate, setHasCreatedTemplate] = useState(false)\r\n\r\n    const dispatchEvent = (name, detail) => context.event.dispatchEvent(new CustomEvent(name, { detail }))\r\n\r\n    const registerUsage = async () => {\r\n        // Register template usage\r\n        if(context.currentTemplate) {\r\n            if (!isRegistered.current) {\r\n                await registerTemplateUse(context.currentTemplate.id)\r\n            }\r\n        }\r\n\r\n        // Register sticker usage\r\n        for(let element of elements) {\r\n            if (element.type === \"sticker\" && element.data.id !== undefined) {\r\n                await registerStickerUse(element.data.id)\r\n            }\r\n        }\r\n\r\n        isRegistered.current = true\r\n    }\r\n\r\n    const handleClose = () => {\r\n        isRegistered.current = false\r\n        setHasCreatedTemplate(false)\r\n        onClose()\r\n    }\r\n\r\n    const handleDownloadClick = () => {\r\n        downloadImageFromSrc(imageData)\r\n        registerUsage()\r\n        dispatchEvent(\"downloadImage\")\r\n    }\r\n\r\n    const handleUploadClick = async () => {\r\n        setIsUploading(true)\r\n        \r\n        const file = dataURLToFile(imageData, \"image.png\")\r\n        const link = await uploadImage(file)\r\n        \r\n        setIsUploading(false)\r\n        setLink(link)\r\n        registerUsage()\r\n        dispatchEvent(\"uploadImage\", { link })\r\n    }\r\n\r\n    const handleShareClick = () => {\r\n        setIsShareDialogOpen(true)\r\n        dispatchEvent(\"openShareModal\")\r\n    }\r\n\r\n    const handleTemplateClick = async () => {\r\n        if(!getValues(\"label\")) {\r\n            return\r\n        }\r\n\r\n        // Collect image data\r\n        const label = getValues(\"label\")\r\n        const image = dataURLToFile(context.image, \"image.png\")\r\n        const metaData = {\r\n            textboxes: window.getTextboxes(),\r\n            border: window.getBorder()\r\n        }\r\n\r\n        // Create form data\r\n        const formData = new FormData()\r\n        formData.append(\"password\", context.password)\r\n        formData.append(\"image\", image)\r\n        formData.append(\"label\", label)\r\n        formData.append(\"meta_data\", JSON.stringify(metaData))\r\n\r\n        // Upload data\r\n        uploadTemplate(formData).then(res => {\r\n            if(res.ok) {\r\n                setHasCreatedTemplate(true)\r\n                setIsUploadSnackbarOpen(true)\r\n            }\r\n        })\r\n    }\r\n\r\n    useEffect(() => {\r\n        if(!open) {\r\n            // Reset link when dialog closes\r\n            setLink(null)\r\n        }\r\n    }, [open])\r\n\r\n    return (\r\n        <>\r\n            <Dialog open={open} onClose={handleClose} PaperProps={{ className: classes.innerDialog }}>\r\n                {!imageData ? (\r\n                    <CircularProgress/>\r\n                ) : (\r\n                    <>\r\n                        <img alt=\"\" src={imageData} className={classes.image}/>\r\n\r\n                        <Paper variant=\"outlined\" className={classes.linkWrapper} style={{ display: !link && \"none\" }}>\r\n                            <Typography variant=\"body1\" className={classes.link}>\r\n                                {link}\r\n                            </Typography>\r\n\r\n                            <IconButton className={classes.shareButton} onClick={handleShareClick}>\r\n                                <ShareIcon />\r\n                            </IconButton>\r\n                        </Paper>\r\n\r\n                        {!link && (\r\n                            <div className={classes.uploadButtonWrapper}>\r\n                                <Button\r\n                                    startIcon={<LinkIcon />}\r\n                                    color=\"primary\"\r\n                                    variant=\"outlined\"\r\n                                    onClick={handleUploadClick}\r\n                                    disabled={isUploading}\r\n                                    style={{ width: \"100%\" }}\r\n                                >\r\n                                    Create Link\r\n                                </Button>\r\n\r\n                                {isUploading && <CircularProgress size={24} className={classes.buttonLoader} />}\r\n                            </div>\r\n                        )}\r\n\r\n                        {!IS_ANDROID_APP && (\r\n                            <Button\r\n                                startIcon={<DownloadIcon />}\r\n                                color=\"primary\"\r\n                                variant=\"outlined\"\r\n                                className={classes.button}\r\n                                onClick={handleDownloadClick}\r\n                            >\r\n                                Download\r\n                            </Button>\r\n                        )}\r\n\r\n                        {context.password && !context.currentTemplate && !hasCreatedTemplate && (\r\n                            <>\r\n                                <TextField\r\n                                    inputRef={register()}\r\n                                    name=\"label\"\r\n                                    label=\"Label\"\r\n                                    className={classes.button}\r\n                                    variant=\"outlined\"\r\n                                    defaultValue={context.label}\r\n                                />\r\n                                <Button\r\n                                    startIcon={<PublishIcon />}\r\n                                    color=\"primary\"\r\n                                    variant=\"outlined\"\r\n                                    className={classes.button}\r\n                                    onClick={handleTemplateClick}\r\n                                >\r\n                                    Publish Template\r\n                                </Button>\r\n                            </>\r\n                        )}\r\n\r\n                        <ShareDialog\r\n                            open={isShareDialogOpen}\r\n                            link={link}\r\n                            onOpen={handleShareClick}\r\n                            onClose={() => setIsShareDialogOpen(false)}\r\n                        />\r\n                    </>\r\n                )}\r\n            </Dialog>\r\n\r\n            <Snackbar\r\n                anchorOrigin={{\r\n                    vertical: \"bottom\",\r\n                    horizontal: \"left\"\r\n                }}\r\n                open={isUploadSnackbarOpen}\r\n                autoHideDuration={3000}\r\n                onClose={() => setIsUploadSnackbarOpen(false)}\r\n                message=\"Uploaded\"\r\n                action={\r\n                    <IconButton onClick={() => setIsUploadSnackbarOpen(false)} className={classes.snackbarClose}>\r\n                        <CloseIcon/>\r\n                    </IconButton>\r\n                }\r\n            />\r\n        </>\r\n    )\r\n}\r\n\r\nexport default withBackButtonSupport(ImageDialog, \"image\")","export default function downloadImageFromSrc(src) {\r\n    const a = document.createElement(\"a\")\r\n    a.href = src\r\n    a.download = \"download.png\"\r\n    document.body.appendChild(a)\r\n    a.click()\r\n    document.body.removeChild(a)\r\n}","import React, { useState, useEffect } from \"react\"\r\nimport { Dialog, DialogTitle, Button, TextField, FormGroup } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport { useForm, FormContext } from \"react-hook-form\"\r\n\r\nimport Select from \"./components/Select.js\"\r\nimport Switch from \"./components/Switch.js\"\r\n\r\nimport settingsOptions from \"../../config/settings-options.json\"\r\nimport withBackButtonSupport from \"../../utils/withBackButtonSupport.js\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    form: {\r\n        padding: theme.spacing(2),\r\n        paddingTop: 0\r\n    },\r\n\r\n    applyButton: {\r\n        marginTop: theme.spacing(2)\r\n    },\r\n\r\n    input: {\r\n        marginTop: theme.spacing(1)\r\n    }\r\n}))\r\n\r\nfunction GridDialog({ onClose, open, values }) {\r\n    const { register, getValues, handleSubmit, control, watch, reset, setValue } = useForm()\r\n\r\n    const classes = useStyles()\r\n\r\n    const [spacingError, setSpacingError] = useState(false)\r\n\r\n    const handleClose = () => {\r\n        const values = getValues()\r\n\r\n        // Missing value \"Spacing\"\r\n        if(values.fixedSpacing && !values.spacing) {\r\n            setSpacingError(true)\r\n            return\r\n        } else {\r\n            setSpacingError(false)\r\n        }\r\n\r\n        values.spacing = parseInt(values.spacing)\r\n\r\n        onClose(values)\r\n    }\r\n\r\n    useEffect(() => {\r\n        reset(values)\r\n    }, [values, reset])\r\n\r\n    return (\r\n        <Dialog onClose={handleClose} open={open}>\r\n            <DialogTitle>Set Grid</DialogTitle>\r\n\r\n            <FormContext {...{ control, watch, register, setValue }}>\r\n                <form onSubmit={handleSubmit(handleClose)} className={classes.form}>\r\n                    <FormGroup>\r\n                        {/* Enabled */}\r\n                        <Switch name=\"enabled\" label=\"Enabled\" className={classes.input}/>\r\n\r\n                        {/* Use Fixed Spacing */}\r\n                        <Switch name=\"fixedSpacing\" label=\"Fixed Spacing\" className={classes.input}/>\r\n\r\n                        {/* Color */}\r\n                        <Select\r\n                            name=\"color\"\r\n                            label=\"Color\"\r\n                            options={settingsOptions.colors}\r\n                            className={classes.input}\r\n                            child={({ label, value }) => (\r\n                                <span style={{ color: value }}>{label}</span>\r\n                            )}\r\n                        />\r\n\r\n                        {/* Columns */}\r\n                        <TextField\r\n                            inputRef={register()}\r\n                            className={classes.input}\r\n                            fullWidth\r\n                            type=\"number\"\r\n                            name=\"columns\"\r\n                            label=\"Columns\"\r\n                        />\r\n\r\n                        {/* Rows */}\r\n                        <TextField\r\n                            inputRef={register()}\r\n                            className={classes.input}\r\n                            fullWidth\r\n                            type=\"number\"\r\n                            name=\"rows\"\r\n                            label=\"Rows\"\r\n                        />\r\n\r\n                        {/* Spacing */}\r\n                        <TextField\r\n                            inputRef={register()}\r\n                            className={classes.input}\r\n                            fullWidth\r\n                            type=\"number\"\r\n                            name=\"spacing\"\r\n                            label=\"Spacing (px)\"\r\n                            error={spacingError}\r\n                        />\r\n\r\n                        <Button fullWidth className={classes.applyButton} type=\"submit\">Apply</Button>\r\n                    </FormGroup>\r\n                </form>\r\n            </FormContext>\r\n        </Dialog>\r\n    )\r\n}\r\n\r\nexport default withBackButtonSupport(GridDialog, \"grid\")","const importFile = accept => new Promise(resolve => {\r\n    const input = document.createElement(\"input\")\r\n    input.type = \"file\"\r\n    input.accept = accept\r\n    document.body.appendChild(input)\r\n\r\n    input.onchange = e => {\r\n        const file = e.target.files[0]\r\n        resolve(file)\r\n    }\r\n\r\n    input.click()\r\n    input.remove()\r\n})\r\n\r\nconst fileToImage = file => new Promise(resolve => {\r\n    const reader = new FileReader()\r\n\r\n    reader.onload = () => resolve(reader.result)\r\n\r\n    reader.readAsDataURL(file)\r\n})\r\n\r\nexport default importFile\r\n\r\nexport {\r\n    fileToImage\r\n}","import html2canvas from \"html2canvas\"\r\n\r\nimport { TEXTBOX_PADDING } from \"../config/constants.js\"\r\n\r\nfunction compensateError(clonedDocument) {\r\n    /**\r\n     * Compensate down shifting\r\n     */\r\n    const textboxes = clonedDocument.querySelectorAll(\".textbox\")\r\n    const padding = TEXTBOX_PADDING\r\n\r\n    textboxes.forEach(textbox => {\r\n        const shiftOffset = Math.min(textbox.offsetHeight / 18, padding)\r\n        textbox.style.padding = `${padding - shiftOffset}px ${padding}px ${padding + shiftOffset}px`\r\n    })\r\n\r\n    /**\r\n     * Reverse order of elements\r\n     */\r\n    const elements = Array.from(clonedDocument.querySelectorAll(\".element\"))\r\n    if(elements.length > 0) {\r\n        const parent = elements[0].parentNode\r\n        elements\r\n            .map(node => parent.removeChild(node))\r\n            .reverse()\r\n            .map(node => parent.appendChild(node))\r\n    }\r\n\r\n    /**\r\n     * Remove white border\r\n     */\r\n    const image = clonedDocument.querySelector(\".meme-image\")\r\n    image.style.minWidth = (image.clientWidth + 1) + \"px\"\r\n    image.style.minHeight = (image.clientHeight + 1) + \"px\"\r\n}\r\n\r\nasync function generateImage(container) {\r\n    const canvas = await html2canvas(container, {\r\n        useCORS: true,\r\n        onclone: compensateError\r\n    })\r\n\r\n    return canvas.toDataURL()\r\n}\r\n\r\nexport default generateImage","import React, { useContext, useEffect, useState, useRef } from \"react\"\r\nimport { IconButton } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport PhotoLibraryIcon from \"@material-ui/icons/PhotoLibrary\"\r\nimport CloudDownloadIcon from \"@material-ui/icons/CloudDownload\"\r\n\r\nimport Textbox from \"./Elements/Textbox.js\"\r\nimport Sticker from \"./Elements/Sticker.js\"\r\nimport Grid from \"./Grid.js\"\r\nimport BorderDialog from \"../Dialogs/BorderDialog.js\"\r\nimport ImageDialog from \"../Dialogs/ImageDialog.js\"\r\nimport GridDialog from \"../Dialogs/GridDialog.js\"\r\n\r\nimport { AppContext } from \"../../App.js\"\r\n\r\nimport importFile, { fileToImage } from \"../../utils/importFile.js\"\r\nimport generateImage from \"../../utils/generateImage.js\"\r\n\r\nfunction showCanvas (canvas) {\r\n    const newWindow = window.open(\"\", \"canvas\")\r\n    newWindow.document.body.appendChild(canvas)\r\n}\r\n\r\nfunction getDimensionsWithoutPadding(element) {\r\n    const styles = getComputedStyle(element)\r\n\r\n    return {\r\n        width: element.clientWidth - parseFloat(styles.paddingLeft) - parseFloat(styles.paddingRight),\r\n        height: element.clientHeight - parseFloat(styles.paddingTop) - parseFloat(styles.paddingBottom)\r\n    }\r\n}\r\n\r\nasync function waitFrames(amount = 1) {\r\n    for(let i = 0; i < amount; i++) {\r\n        await new Promise(requestAnimationFrame)\r\n    }\r\n}\r\n\r\nconst defaultBorderValues = {\r\n    size: 0,\r\n    top: true,\r\n    bottom: true,\r\n    left: false,\r\n    right: false,\r\n    color: \"white\"\r\n}\r\n\r\nconst defaultGridValues = {\r\n    enabled: false,\r\n    fixedSpacing: false,\r\n    color: \"black\",\r\n    spacing: undefined,\r\n    columns: 16,\r\n    rows: 16\r\n}\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    canvasWrapper: {\r\n        position: \"absolute\",\r\n        top: 0, bottom: 0,\r\n        left: 0, right: 0,\r\n        backgroundColor: theme.palette.background.default,\r\n        // outline: `${theme.spacing(1)}px solid ${theme.palette.background.default}`,\r\n        padding: theme.spacing(1),\r\n        paddingBottom: theme.mixins.toolbar.minHeight + theme.spacing(1),\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        overflow: \"hidden\"\r\n    },\r\n\r\n    canvas: {\r\n        position: \"relative\",\r\n        display: \"flex\"\r\n    }\r\n}))\r\n\r\nfunction Canvas() {\r\n    const context = useContext(AppContext)\r\n\r\n    const classes = useStyles()\r\n\r\n    const idCounter = useRef(0)\r\n\r\n    const image = useRef()\r\n    const canvas = useRef()\r\n    const container = useRef()\r\n    const elementRefs = useRef({})\r\n\r\n    let [elementKeys, setElementKeys] = useState([])\r\n    const [borderValues, setBorderValues] = useState(defaultBorderValues)\r\n    const [gridValues, setGridValues] = useState(defaultGridValues)\r\n    const [isBorderDialogOpen, setIsBorderDialogOpen] = useState(false)\r\n    const [isImageDialogOpen, setIsImageDialogOpen] = useState(false)\r\n    const [isGridDialogOpen, setIsGridDialogOpen] = useState(false)\r\n    const [generatedImage, setGeneratedImage] = useState(null)\r\n\r\n    elementRefs.current = {}\r\n    for (let element of elementKeys) {\r\n        elementRefs.current[element.key] = {}\r\n    }\r\n\r\n    const handleBorderDialogClose = (values) => {\r\n        if(values) {\r\n            setBorderValues(values)\r\n        }\r\n        setIsBorderDialogOpen(false)\r\n    }\r\n\r\n    const handleGridDialogClose = (values) => {\r\n        if(values) {\r\n            setGridValues(values)\r\n        }\r\n        setIsGridDialogOpen(false)\r\n    }\r\n\r\n    const handleImageDialogClose = async () => {\r\n        setIsImageDialogOpen(false)\r\n        // Wait until dialog is closed\r\n        await waitFrames(3)\r\n        setGeneratedImage(null)\r\n    }\r\n\r\n    const handleRemoveElement = (removeKey) => {\r\n        const newKeys = elementKeys.filter(({ key }) => key !== removeKey)\r\n        setElementKeys(newKeys)\r\n\r\n        delete elementRefs.current[removeKey]\r\n    }\r\n\r\n    const clearElements = () => {\r\n        setElementKeys([])\r\n        elementRefs.current = {}\r\n    }\r\n\r\n    const createNewElement = (type, data) => {\r\n        const newElementKey = {\r\n            type,\r\n            data,\r\n            key: idCounter.current++\r\n        }\r\n\r\n        return newElementKey\r\n    }\r\n\r\n    const handleAddTextbox = ({ template }) => {\r\n        const newElementKey = createNewElement(\"textbox\", { template })\r\n\r\n        setElementKeys([...elementKeys, newElementKey])\r\n\r\n        return newElementKey\r\n    }\r\n\r\n    const addSticker = (src, id) => {\r\n        const newElementKey = createNewElement(\"sticker\", { src, id })\r\n        setElementKeys([...elementKeys, newElementKey])\r\n    }\r\n\r\n    const handleImportSticker = async () => {\r\n        const file = await importFile(\"image/*\")\r\n        const base64Image = await fileToImage(file)\r\n        addSticker(base64Image)\r\n    }\r\n\r\n    const beforeCapturing = async container => {\r\n        Object.values(elementRefs.current).forEach(textbox => textbox.beforeCapturing())\r\n        \r\n        // Wait until the dom changes have applied\r\n        await waitFrames(3)\r\n    }\r\n\r\n    const afterCapturing = container => {\r\n        Object.values(elementRefs.current).forEach(textbox => textbox.afterCapturing())\r\n    }\r\n\r\n    const handleImportImage = async () => {\r\n        const file = await importFile(\"image/*\")\r\n        const base64Image = await fileToImage(file)\r\n\r\n        clearElements()\r\n        context.set({\r\n            currentTemplate: null,\r\n            image: base64Image\r\n        })\r\n    }\r\n\r\n    const handleGenerateImage = async () => {\r\n        setIsImageDialogOpen(true)\r\n\r\n        // Wait until component got rendered and the textbox handles got applied\r\n        await waitFrames(1)\r\n\r\n        const container = document.querySelector(`.${classes.canvas}`)\r\n\r\n        await beforeCapturing(container)\r\n\r\n        const imageData = await generateImage(container)\r\n\r\n        setGeneratedImage(imageData)\r\n        \r\n        afterCapturing(container)\r\n    }\r\n\r\n    const handleSetBorder = () => {\r\n        setIsBorderDialogOpen(true)\r\n    }\r\n\r\n    const handleSetGrid = () => {\r\n        setIsGridDialogOpen(true)\r\n    }\r\n\r\n    const handleLoadTemplate = async ({ detail: { template } }) => {\r\n        context.set({\r\n            currentTemplate: template,\r\n            image: template.image_url\r\n        })\r\n\r\n        // Wait until image is loaded into DOM and resized\r\n        await waitFrames(2)\r\n        \r\n        // Check if value is given as percentage string and convert it if true\r\n        const formatPercentage = (object, selector, useWidth = false) => {\r\n            if(/\\d+%/.test(object[selector])) {\r\n                const percentage = parseFloat(object[selector])\r\n                object[selector] = (useWidth ? image.current.clientWidth : image.current.clientHeight) * (percentage / 100)\r\n            }\r\n        }\r\n\r\n        // Delete all elements\r\n        clearElements()\r\n        elementKeys = []\r\n\r\n        // Stop if no metadata exists\r\n        if(!template.meta_data) {\r\n            return\r\n        }\r\n\r\n        const border = template.meta_data.border\r\n        const textboxes = template.meta_data.textboxes\r\n\r\n        // Format border size\r\n        if (typeof border?.size === \"string\") {\r\n            formatPercentage(border, \"size\")\r\n        }\r\n\r\n        // Set border\r\n        setBorderValues(border || defaultBorderValues)\r\n\r\n        // Handle textboxes\r\n        if(textboxes) {\r\n            for(let textbox of textboxes){\r\n                // Format values\r\n                formatPercentage(textbox, \"width\", true)\r\n                formatPercentage(textbox, \"height\")\r\n                formatPercentage(textbox, \"x\", true)\r\n                formatPercentage(textbox, \"y\")\r\n\r\n                // Add textbox\r\n                const newKey = handleAddTextbox({ template: textbox })\r\n                elementKeys.push(newKey)\r\n            }\r\n        }\r\n\r\n        // Set new keys\r\n        setElementKeys(elementKeys)\r\n    }\r\n\r\n    const handleLoadSticker = ({ detail: { sticker } }) => {\r\n        addSticker(sticker.image_url, sticker.id)\r\n    }\r\n\r\n    const handleGetTextboxes = () => {\r\n        const textboxKeys = elementKeys.filter(({ type }) => type === \"textbox\").map(({ key }) => key)\r\n        const formatted = textboxKeys.map(key => elementRefs.current[key].toObject({ image: image.current }))\r\n\r\n        return formatted\r\n    }\r\n\r\n    const handleGetBorder = () => {\r\n        return borderValues\r\n    }\r\n\r\n    // Set event listeners\r\n    useEffect(() => {\r\n        context.event.addEventListener(\"importImage\", handleImportImage)\r\n        context.event.addEventListener(\"addTextbox\", handleAddTextbox)\r\n        context.event.addEventListener(\"importSticker\", handleImportSticker)\r\n        context.event.addEventListener(\"generateImage\", handleGenerateImage)\r\n        context.event.addEventListener(\"setBorder\", handleSetBorder)\r\n        context.event.addEventListener(\"setGrid\", handleSetGrid)\r\n        context.event.addEventListener(\"loadTemplate\", handleLoadTemplate)\r\n        context.event.addEventListener(\"loadSticker\", handleLoadSticker)\r\n\r\n        window.getTextboxes = handleGetTextboxes\r\n        window.getBorder = handleGetBorder\r\n        \r\n        return () => {\r\n            context.event.removeEventListener(\"importImage\", handleImportImage)\r\n            context.event.removeEventListener(\"addTextbox\", handleAddTextbox)\r\n            context.event.removeEventListener(\"importSticker\", handleImportSticker)\r\n            context.event.removeEventListener(\"generateImage\", handleGenerateImage)\r\n            context.event.removeEventListener(\"setBorder\", handleSetBorder)\r\n            context.event.removeEventListener(\"setGrid\", handleSetGrid)\r\n            context.event.removeEventListener(\"loadTemplate\", handleLoadTemplate)\r\n            context.event.removeEventListener(\"loadSticker\", handleLoadSticker)\r\n        }\r\n    })\r\n\r\n    // Set image dimensions\r\n    useEffect(() => {\r\n        (async () => {\r\n            // Wait until image is loaded\r\n            await waitFrames(1)\r\n\r\n            if (!image.current || !container.current || !canvas.current) {\r\n                return\r\n            }\r\n\r\n            // Get image dimensions\r\n            const imgWidth = image.current.naturalWidth\r\n            const imgHeight = image.current.naturalHeight\r\n            const imgRatio = imgHeight / imgWidth\r\n\r\n            // Get container size\r\n            const { width: maxWidth, height: maxHeight } = getDimensionsWithoutPadding(container.current)\r\n\r\n            let newWidth, newHeight\r\n\r\n            if (maxWidth * imgRatio > maxHeight) {\r\n                // Height is larger than max height => Constrain height\r\n                const margin = 32\r\n                const borderSize = (borderValues.top || 0 + borderValues.bottom || 0) * borderValues.size\r\n                newHeight = maxHeight - margin - borderSize\r\n                newWidth = newHeight * (1 / imgRatio)\r\n            } else {\r\n                // Width is larger than max width => Constrain width\r\n                const borderSize = (borderValues.left || 0 + borderValues.right || 0) * borderValues.size\r\n                newWidth = maxWidth - borderSize\r\n                newHeight = newWidth * imgRatio\r\n            }\r\n\r\n            newWidth = Math.floor(newWidth)\r\n            newHeight = Math.floor(newHeight)\r\n\r\n            // Apply sizing to image\r\n            image.current.style.width = newWidth + \"px\"\r\n            image.current.style.height = newHeight + \"px\"\r\n\r\n            // Apply sizing to canvas\r\n            canvas.current.style.width = newWidth + \"px\"\r\n            canvas.current.style.height = newHeight + \"px\"\r\n        })()\r\n    }, [context.image, image, container, canvas, borderValues])\r\n\r\n    return (\r\n        <div className={classes.canvasWrapper} ref={container}>\r\n            <div \r\n                className={classes.canvas} \r\n                style={{\r\n                    paddingTop: borderValues.top && borderValues.size + \"px\",\r\n                    paddingBottom: borderValues.bottom && borderValues.size + \"px\",\r\n                    paddingLeft: borderValues.left && borderValues.size + \"px\",\r\n                    paddingRight: borderValues.right && borderValues.size + \"px\",\r\n                    backgroundColor: context.image && borderValues.color,\r\n                    width: !context.image && \"unset\"\r\n                }}\r\n                ref={canvas}\r\n            >\r\n                {context.image ? (\r\n                    <img\r\n                        alt=\"\"\r\n                        src={context.image}\r\n                        className=\"meme-image\"\r\n                        ref={image}\r\n                        draggable=\"false\"\r\n                    />\r\n                ) : (\r\n                    <>\r\n                        <IconButton onClick={() => context.event.dispatchEvent(new CustomEvent(\"openTemplatesDialog\"))}>\r\n                            <CloudDownloadIcon fontSize=\"large\" />\r\n                        </IconButton>\r\n                        \r\n                        <IconButton onClick={handleImportImage}>\r\n                            <PhotoLibraryIcon fontSize=\"large\" />\r\n                        </IconButton>\r\n                    </>\r\n                )}\r\n\r\n                {elementKeys.map(({ type, key, data }) => {\r\n                    if(type === \"textbox\") {\r\n                        return (\r\n                            <Textbox\r\n                                key={key}\r\n                                id={key}\r\n                                onRemove={handleRemoveElement}\r\n                                handle={elementRefs.current[key]}\r\n                                grid={gridValues}\r\n                                template={data.template}\r\n                                canvas={canvas.current}\r\n                            />\r\n                        )\r\n                    } else if (type === \"sticker\") {\r\n                        return (\r\n                            <Sticker\r\n                                key={key}\r\n                                id={key}\r\n                                onRemove={handleRemoveElement}\r\n                                handle={elementRefs.current[key]}\r\n                                grid={gridValues}\r\n                                canvas={canvas.current}\r\n                                src={data.src}\r\n                            />\r\n                        )\r\n                    }\r\n\r\n                    throw new Error(\"Type \" + type + \" is not defined\")\r\n                })}\r\n            </div>\r\n\r\n            <Grid config={gridValues} canvas={canvas.current} border={borderValues}/>\r\n\r\n            <BorderDialog open={isBorderDialogOpen} onClose={handleBorderDialogClose} values={borderValues}/>\r\n            <GridDialog open={isGridDialogOpen} onClose={handleGridDialogClose} values={gridValues}/>\r\n            <ImageDialog open={isImageDialogOpen} onClose={handleImageDialogClose} imageData={generatedImage} elements={elementKeys}/>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Canvas","import React, { useContext } from \"react\"\r\nimport { Menu as MuiMenu, MenuItem, ListItemIcon, ListItemText } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport BorderOuterIcon from \"@material-ui/icons/BorderOuter\"\r\nimport GridIcon from \"@material-ui/icons/GridOn\"\r\nimport AddPhotoIcon from \"@material-ui/icons/AddPhotoAlternate\"\r\nimport PhotoLibraryIcon from \"@material-ui/icons/PhotoLibrary\"\r\n\r\nimport { AppContext } from \"../../App.js\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    icon: {\r\n        minWidth: theme.spacing(4)\r\n    }\r\n}))\r\n\r\nfunction Menu({ open, anchorEl, onClose }) {\r\n    const context = useContext(AppContext)\r\n\r\n    const classes = useStyles()\r\n\r\n    const dispatchEvent = (name) => () => {\r\n        context.event.dispatchEvent(new CustomEvent(name))\r\n        onClose()\r\n    } \r\n\r\n    return (\r\n        <MuiMenu\r\n            open={open}\r\n            anchorEl={anchorEl}\r\n            onClose={onClose}\r\n            anchorOrigin={{\r\n                vertical: \"top\",\r\n                horizontal: \"left\"\r\n            }}\r\n            transformOrigin={{\r\n                vertical: \"bottom\",\r\n                horizontal: \"left\"\r\n            }}\r\n        >\r\n            <MenuItem onClick={dispatchEvent(\"setBorder\")}>\r\n                <ListItemIcon className={classes.icon}>\r\n                    <BorderOuterIcon fontSize=\"small\"/>\r\n                </ListItemIcon>\r\n                <ListItemText primary=\"Border\"/>\r\n            </MenuItem>\r\n\r\n            <MenuItem onClick={dispatchEvent(\"setGrid\")}>\r\n                <ListItemIcon className={classes.icon}>\r\n                    <GridIcon fontSize=\"small\"/>\r\n                </ListItemIcon>\r\n                <ListItemText primary=\"Grid\"/>\r\n            </MenuItem>\r\n\r\n            <MenuItem onClick={dispatchEvent(\"importSticker\")}>\r\n                <ListItemIcon className={classes.icon}>\r\n                    <AddPhotoIcon fontSize=\"small\" />\r\n                </ListItemIcon>\r\n                <ListItemText primary=\"Import Sticker\" />\r\n            </MenuItem>\r\n\r\n            <MenuItem onClick={dispatchEvent(\"importImage\")}>\r\n                <ListItemIcon className={classes.icon}>\r\n                    <PhotoLibraryIcon fontSize=\"small\" />\r\n                </ListItemIcon>\r\n                <ListItemText primary={context.image ? \"Replace Meme\" : \"Import Meme\"} />\r\n            </MenuItem>\r\n        </MuiMenu>\r\n    )\r\n}\r\n\r\nexport default Menu","import React from \"react\"\r\nimport { Dialog, DialogTitle, DialogContent, DialogActions, Button, Typography } from \"@material-ui/core\"\r\n\r\nfunction ConfirmDialog({ onClose, open, content }) {\r\n    const handleCancel = () => onClose(false)\r\n\r\n    const handleAccept = () => onClose(true)\r\n\r\n    return (\r\n        <Dialog\r\n            disableBackdropClick\r\n            disableEscapeKeyDown\r\n            open={open}\r\n        >\r\n            <DialogTitle>Confirm</DialogTitle>\r\n            \r\n            <DialogContent dividers>\r\n                <Typography>{content}</Typography>\r\n            </DialogContent>\r\n\r\n            <DialogActions>\r\n                <Button onClick={handleCancel}>Cancel</Button>\r\n                <Button onClick={handleAccept}>Ok</Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n    )\r\n}\r\n\r\nexport default ConfirmDialog","import React, { useState, useContext, useEffect, useRef } from \"react\"\r\nimport { IconButton, GridList, GridListTile, GridListTileBar, CircularProgress, InputBase, Paper } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport DeleteIcon from \"@material-ui/icons/Delete\"\r\nimport CloseIcon from \"@material-ui/icons/Close\"\r\n\r\nimport { AppContext } from \"../../../App.js\"\r\nimport ConfirmDialog from \"../ConfirmDialog.js\"\r\n\r\nimport { getTemplates, deleteTemplate } from \"../../../utils/API.js\"\r\nimport { cacheImage } from \"../../../utils/cache.js\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    spacer: {\r\n        height: theme.spacing(2)\r\n    },\r\n\r\n    searchWrapper: {\r\n        margin: `${theme.spacing(2)}px ${theme.spacing(1)}px`,\r\n        marginTop: 0,\r\n        padding: \"2px 4px\",\r\n        display: \"flex\"\r\n    },\r\n\r\n    search: {\r\n        marginLeft: theme.spacing(1),\r\n        flex: 1\r\n    },\r\n\r\n    searchClear: {\r\n        padding: theme.spacing(1)\r\n    },\r\n    \r\n    listWrapper: {\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        overflow: \"hidden\"\r\n    },\r\n\r\n    list: {\r\n        maxWidth: 400,\r\n        width: \"100%\"\r\n    },\r\n\r\n    tile: {\r\n        cursor: \"pointer\"\r\n    },\r\n\r\n    tilebar: {\r\n        height: 56\r\n    },\r\n\r\n    deleteButton: {\r\n        zIndex: 10,\r\n        position: \"absolute\",\r\n        top: 0,\r\n        left: 0\r\n    }\r\n}))\r\n\r\nconst getSubtitle = (count) => {\r\n    if (count === 1) {\r\n        return \"1 Meme Created\"\r\n    } else {\r\n        return count + \" Memes Created\"\r\n    }\r\n}\r\n\r\nfunction Templates({ onLoad }) {\r\n    const context = useContext(AppContext)\r\n\r\n    const classes = useStyles()\r\n\r\n    const currentTemplate = useRef({})\r\n\r\n    const [templates, setTemplates] = useState()\r\n    const [isConfirmDialogOpen, setIsConfirmDialogOpen] = useState(false)\r\n    const [search, setSearch] = useState(\"\")\r\n\r\n    const fetchTemplates = () => {\r\n        getTemplates()\r\n            .then(data => setTemplates(data))\r\n    }\r\n\r\n    const handleDeleteClick = (template) => {\r\n        currentTemplate.current = template\r\n        setIsConfirmDialogOpen(true)\r\n    }\r\n\r\n    const handleConfirmDialogClose = (shouldDelete) => {\r\n        setIsConfirmDialogOpen(false)\r\n\r\n        if (shouldDelete) {\r\n            deleteTemplate(context.password, currentTemplate.current.id)\r\n                .then(fetchTemplates)\r\n        }\r\n    }\r\n\r\n    const handleClick = (event, template) => {\r\n        // Prevent loading when delete icon got clicked\r\n        if (event.target.tagName === \"DIV\" || event.target.tagName === \"IMG\") {\r\n            onLoad(template)\r\n        }\r\n    }\r\n\r\n    const handleSearchChange = event => {\r\n        setSearch(event.target.value)\r\n    }\r\n\r\n    const handleImageLoad = (template) => {\r\n        cacheImage(template.image_url)\r\n    }\r\n\r\n    useEffect(() => {\r\n        fetchTemplates()\r\n    }, [])\r\n\r\n    if (!templates) {\r\n        return <CircularProgress />\r\n    }\r\n\r\n    // Filter by search string\r\n    const renderTemplates = templates.filter(({ label }) => label.toLowerCase().includes(search.toLowerCase()))\r\n\r\n    // Sort by usage => Push most used memes to the top\r\n    renderTemplates.sort((a, b) => b.amount_uses - a.amount_uses)\r\n\r\n    return (\r\n        <>\r\n            <div className={classes.spacer}/>\r\n\r\n            <Paper variant=\"outlined\" className={classes.searchWrapper}>\r\n                <InputBase value={search} onChange={handleSearchChange} placeholder=\"Search\" className={classes.search} />\r\n\r\n                <IconButton onClick={() => setSearch(\"\")} className={classes.searchClear}>\r\n                    <CloseIcon />\r\n                </IconButton>\r\n            </Paper>\r\n\r\n            <div className={classes.listWrapper}>\r\n                <GridList cellHeight={150} className={classes.list}>\r\n                    {renderTemplates.map((template, i) => (\r\n                        <GridListTile key={i} className={classes.tile} onClick={e => handleClick(e, template)}>\r\n                            <img src={template.image_url} alt={template.label} loading=\"lazy\" onLoad={() => handleImageLoad(template)}/>\r\n\r\n                            <GridListTileBar title={template.label} subtitle={getSubtitle(template.amount_uses)} className={classes.tilebar} />\r\n\r\n                            {context.password && (\r\n                                <IconButton onClick={() => handleDeleteClick(template)} className={classes.deleteButton}>\r\n                                    <DeleteIcon fontSize=\"small\" />\r\n                                </IconButton>\r\n                            )}\r\n                        </GridListTile>\r\n                    ))}\r\n                </GridList>\r\n\r\n                <ConfirmDialog\r\n                    open={isConfirmDialogOpen}\r\n                    onClose={handleConfirmDialogClose}\r\n                    content={`The template \"${currentTemplate.current.label}\" will be deleted`}\r\n                />\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Templates","import React, { useState, useContext, useEffect, useRef } from \"react\"\r\nimport ReactDOM from \"react-dom\"\r\nimport { IconButton, GridList, GridListTile, CircularProgress, Fab, Zoom } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport DeleteIcon from \"@material-ui/icons/Delete\"\r\nimport AddIcon from \"@material-ui/icons/Add\"\r\n\r\nimport { AppContext } from \"../../../App.js\"\r\nimport ConfirmDialog from \"../ConfirmDialog.js\"\r\n\r\nimport { getStickers, deleteSticker, uploadSticker } from \"../../../utils/API.js\"\r\nimport importFile from \"../../../utils/importFile.js\"\r\nimport { cacheImage } from \"../../../utils/cache.js\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    listWrapper: {\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        overflow: \"hidden\"\r\n    },\r\n\r\n    list: {\r\n        maxWidth: 400,\r\n        paddingTop: theme.spacing(1),\r\n        width: \"100%\"\r\n    },\r\n\r\n    tile: {\r\n        cursor: \"pointer\",\r\n        \r\n        \"& div\": {\r\n            display: \"flex\",\r\n            justifyContent: \"center\",\r\n            alignItems: \"center\"\r\n        }\r\n    },\r\n\r\n    deleteButton: {\r\n        zIndex: 10,\r\n        position: \"absolute\",\r\n        top: 0,\r\n        left: 0\r\n    },\r\n\r\n    addButton: {\r\n        position: \"fixed\",\r\n        right: theme.spacing(2),\r\n        bottom: theme.spacing(2)\r\n    }\r\n}))\r\n\r\nfunction InnerTile({ sticker, onDelete }) {\r\n    const context = useContext(AppContext)\r\n\r\n    const classes = useStyles()\r\n\r\n    const image = useRef()\r\n\r\n    const resizeImage = () => {\r\n        if (!image.current) {\r\n            return\r\n        }\r\n\r\n        // Set image dimensions\r\n        if (image.current.naturalWidth >= image.current.naturalHeight) {\r\n            image.current.style.width = \"100%\"\r\n        } else if (image.current.naturalHeight > image.current.naturalWidth) {\r\n            image.current.style.height = \"100%\"\r\n        }\r\n    }\r\n\r\n    const handleImageLoad = () => {\r\n        cacheImage(sticker.image_url)\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (!image.current) {\r\n            return\r\n        }\r\n\r\n        image.current.onload = () => {\r\n            resizeImage()\r\n        }\r\n    }, [])\r\n    \r\n    return (\r\n        <>\r\n            <img src={sticker.image_url} alt=\"Sticker\" loading=\"lazy\" ref={image} onLoad={handleImageLoad}/>\r\n\r\n            {context.password && (\r\n                <IconButton onClick={() => onDelete(sticker)} className={classes.deleteButton}>\r\n                    <DeleteIcon fontSize=\"small\" />\r\n                </IconButton>\r\n            )}\r\n        </>\r\n    )\r\n}\r\n\r\nfunction Stickers({ onLoad, active }) {\r\n    const context = useContext(AppContext)\r\n\r\n    const classes = useStyles()\r\n\r\n    const currentSticker = useRef({})\r\n\r\n    const [stickers, setStickers] = useState()\r\n    const [isConfirmDialogOpen, setIsConfirmDialogOpen] = useState(false)\r\n\r\n    const fetchStickers = () => {\r\n        getStickers()\r\n            .then(data => setStickers(data))\r\n    }\r\n\r\n    const handleDelete = (sticker) => {\r\n        currentSticker.current = sticker\r\n        setIsConfirmDialogOpen(true)\r\n    }\r\n\r\n    const handleConfirmDialogClose = (shouldDelete) => {\r\n        setIsConfirmDialogOpen(false)\r\n\r\n        if (shouldDelete) {\r\n            deleteSticker(context.password, currentSticker.current.id)\r\n                .then(fetchStickers)\r\n        }\r\n    }\r\n\r\n    const handleClick = (event, sticker) => {\r\n        // Prevent loading when delete icon got clicked\r\n        if (event.target.tagName === \"DIV\" || event.target.tagName === \"IMG\") {\r\n            onLoad(sticker)\r\n        }\r\n    }\r\n\r\n    const handleAddSticker = async () => {\r\n        // Import image\r\n        const image = await importFile(\"image/*\")\r\n\r\n        // Create form data\r\n        const formData = new FormData()\r\n        formData.append(\"image\", image)\r\n        formData.append(\"password\", context.password)\r\n\r\n        // Upload image\r\n        await uploadSticker(formData)\r\n        fetchStickers()\r\n    }\r\n\r\n    useEffect(() => {\r\n        fetchStickers()\r\n    }, [])\r\n\r\n    if (!stickers) {\r\n        return <CircularProgress />\r\n    }\r\n\r\n    // Sort by usage => Push most used stickers to the top\r\n    stickers.sort((a, b) => b.amount_uses - a.amount_uses)\r\n\r\n    return (\r\n        <div className={classes.listWrapper}>\r\n            <GridList className={classes.list} cols={3}>\r\n                {stickers.map((sticker, i) => (\r\n                    <GridListTile className={classes.tile} onClick={e => handleClick(e, sticker)} key={i}>\r\n                        <InnerTile sticker={sticker} onDelete={handleDelete}/>\r\n                    </GridListTile>    \r\n                ))}\r\n            </GridList>\r\n\r\n            <ConfirmDialog\r\n                open={isConfirmDialogOpen}\r\n                onClose={handleConfirmDialogClose}\r\n                content={`Sticker ${currentSticker.current.id} will be deleted`}\r\n            />\r\n            \r\n            {context.password && ReactDOM.createPortal((\r\n                <Zoom in={active} unmountOnExit>\r\n                    <Fab color=\"secondary\" className={classes.addButton} onClick={handleAddSticker}>\r\n                        <AddIcon />\r\n                    </Fab>\r\n                </Zoom>\r\n            ), document.getElementById(\"templates-dialog-inner-container\"))}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Stickers","import React, { useState, useContext } from \"react\"\r\nimport { Dialog, AppBar, Toolbar, IconButton, Slide, Tabs, Tab } from \"@material-ui/core\"\r\nimport SwipeableViews from \"react-swipeable-views\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport CloseIcon from \"@material-ui/icons/Close\"\r\n\r\nimport Templates from \"./components/Templates.js\"\r\nimport Stickers from \"./components/Stickers.js\"\r\n\r\nimport { AppContext } from \"../../App.js\"\r\nimport withBackButtonSupport from \"../../utils/withBackButtonSupport.js\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    dialog: {\r\n        width: props => props.width,\r\n        left: \"50% !important\",\r\n        transform: \"translateX(-50%)\"\r\n    },\r\n\r\n    appBar: {\r\n        position: \"absolute\"\r\n    },\r\n\r\n    toolbar: {\r\n        minHeight: 46\r\n    },\r\n\r\n    body: {\r\n        marginTop: 46\r\n    }\r\n}))\r\n\r\nconst Transition = React.forwardRef(function Transition(props, ref) {\r\n    return <Slide direction=\"up\" ref={ref} {...props}/>\r\n})\r\n\r\nfunction TemplatesDialog({ onClose, open }) {\r\n    const context = useContext(AppContext)\r\n\r\n    const classes = useStyles({\r\n        width: context.width\r\n    })\r\n\r\n    const [currentTab, setCurrentTab] = useState(0)\r\n\r\n    const handleClose = () => {\r\n        onClose()\r\n    }\r\n\r\n    const handleTemplateLoad = (template) => {\r\n        context.event.dispatchEvent(new CustomEvent(\"loadTemplate\", { detail: { template } }))\r\n        handleClose()\r\n    }\r\n\r\n    const handleStickerLoad = (sticker) => {\r\n        context.event.dispatchEvent(new CustomEvent(\"loadSticker\", { detail: { sticker } }))\r\n        handleClose()\r\n    }\r\n\r\n    const scrollToTop = () => {\r\n        document.getElementById(\"templates-dialog-inner-container\").scrollTo(0, 0)\r\n    }\r\n\r\n    const handleTabChange = (event, index) => {\r\n        setCurrentTab(index)\r\n        scrollToTop()\r\n    }\r\n\r\n    const handleChangeIndex = (index) => {\r\n        setCurrentTab(index)\r\n        scrollToTop()\r\n    }\r\n\r\n    return (\r\n        <Dialog fullScreen onClose={handleClose} open={open} TransitionComponent={Transition} className={classes.dialog}>\r\n            <AppBar className={classes.appBar}>\r\n                <Toolbar className={classes.toolbar}>\r\n                    <IconButton edge=\"start\" color=\"inherit\" onClick={handleClose}>\r\n                        <CloseIcon fontSize=\"small\"/>\r\n                    </IconButton>\r\n\r\n                    <Tabs value={currentTab} onChange={handleTabChange}>\r\n                        <Tab label=\"Templates\"/>\r\n                        <Tab label=\"Stickers\"/>\r\n                    </Tabs>\r\n                </Toolbar>\r\n            </AppBar>\r\n\r\n            <SwipeableViews index={currentTab} onChangeIndex={handleChangeIndex} axis=\"x\" id=\"templates-dialog-inner-container\" disableLazyLoading>\r\n                <div className={classes.body}>\r\n                    <Templates onLoad={handleTemplateLoad} active={currentTab === 0}/>\r\n                </div>\r\n\r\n                <div className={classes.body}>\r\n                    <Stickers onLoad={handleStickerLoad} active={currentTab === 1}/>\r\n                </div>\r\n            </SwipeableViews>\r\n        </Dialog>\r\n    )\r\n}\r\n\r\nexport default withBackButtonSupport(TemplatesDialog, \"templates\")","import React from \"react\"\r\nimport { Dialog, ClickAwayListener, Tooltip } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\n\r\nimport data from \"../../config/help-overlay-data.json\"\r\nimport withBackButtonSupport from \"../../utils/withBackButtonSupport.js\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    innerDialog: {\r\n        background: \"none\",\r\n        overflow: \"hidden\"\r\n    }\r\n}))\r\n\r\nconst tooltipOffset = 20\r\n\r\nfunction OverlayChild({ data: { selector, content }, open }) {\r\n    const rect = document.querySelector(selector).getBoundingClientRect()\r\n    \r\n    return (\r\n        <Tooltip\r\n            open={open}\r\n            placement=\"top\"\r\n            arrow\r\n            title={content}\r\n        >\r\n            <div style={{\r\n                position: \"absolute\",\r\n                top: rect.top + tooltipOffset,\r\n                left: rect.left,\r\n                width: rect.width + \"px\",\r\n                height: rect.height + \"px\"\r\n            }}/>\r\n        </Tooltip>\r\n    )\r\n}\r\n\r\nfunction HelpDialog({ open, onClose }) {\r\n    const classes = useStyles()\r\n\r\n    return (\r\n        <Dialog\r\n            open={open}\r\n            onClose={onClose}\r\n            fullScreen\r\n            PaperProps={{ className: classes.innerDialog }}\r\n        >\r\n            <ClickAwayListener onClickAway={onClose}>\r\n                <div>\r\n                    {data.map((data, i) => <OverlayChild data={data} key={i} open={open}/>)}\r\n                </div>\r\n            </ClickAwayListener>\r\n        </Dialog>\r\n    )\r\n}\r\n\r\nexport default withBackButtonSupport(HelpDialog, \"help\")","import React, { useState, useContext } from \"react\"\r\nimport { Dialog, DialogTitle, Button, TextField, FormGroup, Snackbar, IconButton } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport { useForm, FormContext } from \"react-hook-form\"\r\nimport CloseIcon from \"@material-ui/icons/Close\"\r\n\r\nimport { AppContext } from \"../../App.js\"\r\nimport withBackButtonSupport from \"../../utils/withBackButtonSupport.js\"\r\nimport { authorize } from \"../../utils/API.js\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    form: {\r\n        padding: theme.spacing(2),\r\n        paddingTop: 0\r\n    },\r\n\r\n    applyButton: {\r\n        marginTop: theme.spacing(2)\r\n    },\r\n\r\n    input: {\r\n        marginTop: theme.spacing(1)\r\n    },\r\n\r\n    snackbarClose: {\r\n        color: theme.palette.primary.variant\r\n    }\r\n}))\r\n\r\nfunction BorderDialog({ onClose, open }) {\r\n    const context = useContext(AppContext)\r\n\r\n    const { register, getValues, handleSubmit, control, watch, setValue } = useForm()\r\n\r\n    const classes = useStyles()\r\n\r\n    const [isSnackbarOpen, setIsSnackbarOpen] = useState(false)\r\n    const [isWrongPassword, setIsWrongPassword] = useState(false)\r\n\r\n    const onSubmit = async () => {\r\n        const password = getValues(\"password\")\r\n\r\n        const res = await authorize(password)\r\n\r\n        if(res) {\r\n            setIsWrongPassword(false)\r\n            setIsSnackbarOpen(true)\r\n            context.setPassword(password)\r\n            onClose()\r\n        } else {\r\n            setIsWrongPassword(true)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Dialog onClose={onClose} open={open}>\r\n                <DialogTitle>Login</DialogTitle>\r\n\r\n                <FormContext {...{ control, watch, register, setValue }}>\r\n                    <form onSubmit={handleSubmit(onSubmit)} className={classes.form}>\r\n                        <FormGroup>\r\n                            {/* Password */}\r\n                            <TextField\r\n                                error={isWrongPassword}\r\n                                inputRef={register()}\r\n                                className={classes.input}\r\n                                fullWidth\r\n                                type=\"password\"\r\n                                name=\"password\"\r\n                                label=\"Password\"\r\n                                helperText={isWrongPassword && \"Wrong Password\"}\r\n                            />\r\n\r\n                            <Button fullWidth className={classes.applyButton} type=\"submit\">Login</Button>\r\n                        </FormGroup>\r\n                    </form>\r\n                </FormContext>\r\n            </Dialog>\r\n\r\n            <Snackbar\r\n                anchorOrigin={{\r\n                    vertical: \"bottom\",\r\n                    horizontal: \"right\"\r\n                }}\r\n                open={isSnackbarOpen}\r\n                autoHideDuration={3000}\r\n                onClose={() => setIsSnackbarOpen(false)}\r\n                message=\"Logged In\"\r\n                action={\r\n                    <IconButton onClick={() => setIsSnackbarOpen(false)} className={classes.snackbarClose}>\r\n                        <CloseIcon />\r\n                    </IconButton>\r\n                }\r\n            />\r\n        </>\r\n    )\r\n}\r\n\r\nexport default withBackButtonSupport(BorderDialog, \"auth\")","import React, { useContext, useState, useRef, useEffect } from \"react\"\r\nimport { AppBar, Toolbar, Fab, IconButton } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport DoneIcon from \"@material-ui/icons/Done\"\r\nimport TextFieldsIcon from \"@material-ui/icons/TextFields\"\r\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\"\r\nimport CloudDownloadIcon from \"@material-ui/icons/CloudDownload\"\r\nimport HelpIcon from \"@material-ui/icons/Help\"\r\nimport UndoIcon from \"@material-ui/icons/Undo\"\r\n\r\nimport Menu from \"./Menu.js\"\r\nimport TemplatesDialog from \"../Dialogs/TemplatesDialog.js\"\r\nimport HelpDialog from \"../Dialogs/HelpDialog.js\"\r\nimport AuthDialog from \"../Dialogs/AuthDialog.js\"\r\n\r\nimport { AppContext } from \"../../App.js\"\r\nimport { LONG_PRESS_DURATION } from \"../../config/constants.js\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    appBar: {\r\n        position: \"absolute\",\r\n        top: \"unset\",\r\n        bottom: 0,\r\n        left: 0,\r\n        right: \"unset\",\r\n        backgroundColor: theme.palette.background.paper\r\n    },\r\n\r\n    fabButton: {\r\n        position: \"absolute\",\r\n        top: -30,\r\n        left: 0,\r\n        right: 0,\r\n        margin: \"0 auto\"\r\n    },\r\n\r\n    spacer: {\r\n        flexGrow: 1\r\n    }\r\n}))\r\n\r\nfunction BottomBar() {\r\n    const context = useContext(AppContext)\r\n    \r\n    const classes = useStyles()\r\n\r\n    const openMenuButton = useRef()\r\n    const helpButtonTimer = useRef()\r\n\r\n    const [isMenuOpen, setIsMenuOpen] = useState(false)\r\n    const [isTemplatesOpen, setIsTemplatesOpen] = useState(false)\r\n    const [isHelpOpen, setIsHelpOpen] = useState(false)\r\n    const [isAuthDialogOpen, setIsAuthDialogOpen] = useState(false)\r\n\r\n    const handleMoreClick = () => {\r\n        setIsMenuOpen(!isMenuOpen)\r\n    }\r\n\r\n    const handleMenuClose = () => {\r\n        setIsMenuOpen(false)\r\n    }\r\n\r\n    const handleTemplatesClick = () => {\r\n        setIsTemplatesOpen(true)\r\n    }\r\n\r\n    const handleHelpClick = () => {\r\n        setIsHelpOpen(true)\r\n    }\r\n\r\n    const handleTouchStart = () => {\r\n        if(context.password) {\r\n            return\r\n        }\r\n\r\n        helpButtonTimer.current = setTimeout(() => {\r\n            setIsAuthDialogOpen(true)\r\n        }, LONG_PRESS_DURATION)\r\n    }\r\n\r\n    const handleTouchEnd = () => {\r\n        clearTimeout(helpButtonTimer.current)\r\n    }\r\n\r\n    const dispatchEvent = (name) => () => {\r\n        context.event.dispatchEvent(new CustomEvent(name))\r\n    }\r\n\r\n    useEffect(() => {\r\n        context.event.addEventListener(\"openTemplatesDialog\", handleTemplatesClick)\r\n        \r\n        return () => {\r\n            context.event.removeEventListener(\"openTemplatesDialog\", handleTemplatesClick)\r\n        }\r\n    })\r\n\r\n    return (\r\n        <AppBar position=\"fixed\" className={classes.appBar}>\r\n            <Toolbar>\r\n                <IconButton onClick={handleHelpClick} onTouchStart={handleTouchStart} onTouchEnd={handleTouchEnd} onMouseDown={handleTouchStart} onMouseUp={handleTouchEnd}>\r\n                    <HelpIcon/>\r\n                </IconButton>\r\n\r\n                <IconButton onClick={handleTemplatesClick} id=\"templates-button\">\r\n                    <CloudDownloadIcon/>\r\n                </IconButton>\r\n\r\n                <div className={classes.spacer}/>\r\n\r\n                <Fab color=\"primary\" className={classes.fabButton} onClick={dispatchEvent(\"generateImage\")} disabled={!context.image}>\r\n                    <DoneIcon/>\r\n                </Fab>\r\n\r\n                <IconButton onClick={dispatchEvent(\"addTextbox\")} id=\"textbox-button\">\r\n                    <TextFieldsIcon/>\r\n                </IconButton>\r\n\r\n                <IconButton onClick={dispatchEvent(\"undo\")} id=\"undo-button\">\r\n                    <UndoIcon/>\r\n                </IconButton>\r\n\r\n                <IconButton onClick={handleMoreClick} ref={openMenuButton}>\r\n                    <MoreVertIcon/>\r\n                </IconButton>\r\n\r\n                <Menu open={isMenuOpen} anchorEl={openMenuButton.current} onClose={handleMenuClose}/>\r\n\r\n                <TemplatesDialog open={isTemplatesOpen} onClose={() => setIsTemplatesOpen(false)}/>\r\n                <HelpDialog open={isHelpOpen} onClose={() => setIsHelpOpen(false)}/>\r\n                <AuthDialog open={isAuthDialogOpen} onClose={() => setIsAuthDialogOpen(false)}/>\r\n            </Toolbar>\r\n        </AppBar>\r\n    )\r\n}\r\n\r\nexport default BottomBar","import { useContext, useEffect, useState } from \"react\"\r\nimport ReactGA from \"react-ga\"\r\n\r\nimport { AppContext } from \"../App.js\"\r\nimport { GA_TRACKING_ID, IS_DEV } from \"../config/constants.js\"\r\n\r\nfunction Analytics() {\r\n    const context = useContext(AppContext)\r\n    const [isInitialized, setIsInitialized] = useState(false)\r\n\r\n    /**\r\n     * Initialize GA\r\n     */\r\n    useEffect(() => {\r\n        if(context.password || IS_DEV) {\r\n            return\r\n        }\r\n\r\n        ReactGA.initialize(GA_TRACKING_ID)\r\n\r\n        ReactGA.pageview(window.location.pathname)\r\n\r\n        setIsInitialized(true)\r\n    }, [])\r\n\r\n    /**\r\n     * Forward events to GA\r\n     */\r\n    useEffect(() => {\r\n        if(!isInitialized) {\r\n            return\r\n        }\r\n\r\n        const generateImageEvent = ReactGA.event.bind(null, {\r\n            category: \"Editor\",\r\n            action: \"Generate Image\",\r\n            ...(context.currentTemplate ? {\r\n                label: context.currentTemplate.label,\r\n                value: context.currentTemplate.id\r\n            } : {})\r\n        })\r\n\r\n        const loadTemplateEvent = ({ detail: { template } }) => ReactGA.event({\r\n            category: \"Editor\",\r\n            action: \"Load Template\",\r\n            label: template.label,\r\n            value: template.id\r\n        })\r\n        \r\n        const shareModalModalview = () => ReactGA.modalview(\"share\")\r\n\r\n        const uploadImageEvent = ({ detail: { link } }) => ReactGA.event({\r\n            category: \"Editor\",\r\n            action: \"Upload Image\",\r\n            label: link\r\n        })\r\n\r\n        const downloadImageEvent = () => ReactGA.event({\r\n            category: \"Editor\",\r\n            action: \"Download Image\"\r\n        })\r\n\r\n        const shareEvent = ({ detail: { label } }) => ReactGA.event({\r\n            category: \"Editor\",\r\n            action: \"Share\",\r\n            label\r\n        })\r\n\r\n        context.event.addEventListener(\"generateImage\", generateImageEvent)\r\n        context.event.addEventListener(\"loadTemplate\", loadTemplateEvent)\r\n        context.event.addEventListener(\"openShareModal\", shareModalModalview)\r\n        context.event.addEventListener(\"uploadImage\", uploadImageEvent)\r\n        context.event.addEventListener(\"downloadImage\", downloadImageEvent)\r\n        context.event.addEventListener(\"share\", shareEvent)\r\n\r\n        return () => {\r\n            context.event.removeEventListener(\"generateImage\", generateImageEvent)\r\n            context.event.removeEventListener(\"loadTemplate\", loadTemplateEvent)\r\n            context.event.removeEventListener(\"openShareModal\", shareModalModalview)\r\n            context.event.removeEventListener(\"uploadImage\", uploadImageEvent)\r\n            context.event.removeEventListener(\"downloadImage\", downloadImageEvent)\r\n            context.event.removeEventListener(\"share\", shareEvent)\r\n        }\r\n    }, [context, isInitialized])\r\n\r\n    return null\r\n}\r\n\r\nexport default Analytics","import React, { useState, useEffect } from \"react\"\r\nimport { Snackbar, IconButton } from \"@material-ui/core\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport CloseIcon from \"@material-ui/icons/Close\"\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    snackbarClose: {\r\n        color: theme.palette.primary.variant\r\n    }\r\n}))\r\n\r\nfunction OfflineUseAlerts() {\r\n    const classes = useStyles()\r\n\r\n    const [isSnackbarOpen, setIsSnackbarOpen] = useState(false)\r\n    const [snackbarText, setSnackbarText] = useState(\"\")\r\n\r\n    useEffect(() => {\r\n        const channel = new BroadcastChannel(\"sw-0\")\r\n    \r\n        channel.addEventListener(\"message\", function ({ data: message }) {\r\n            if(message === \"content-cached\") {\r\n                setIsSnackbarOpen(true)\r\n                setSnackbarText(\"The app is cached for offline use\")\r\n\r\n            } else if (message === \"content-available\") {\r\n                setIsSnackbarOpen(true)\r\n                setSnackbarText(\"A new version is available. Restart the app to see it\")\r\n\r\n            }\r\n        })\r\n\r\n        return () => channel.close()\r\n    }, [])\r\n\r\n    return ( \r\n        <>\r\n            <Snackbar\r\n                anchorOrigin={{ vertical: \"bottom\", horizontal: \"right\" }}\r\n                open={isSnackbarOpen}\r\n                autoHideDuration={6000}\r\n                message={snackbarText}\r\n                onClose={() => setIsSnackbarOpen(false)}\r\n                action={\r\n                    <IconButton onClick={() => setIsSnackbarOpen(false)} className={classes.snackbarClose}>\r\n                        <CloseIcon/>\r\n                    </IconButton>\r\n                }\r\n            />\r\n        </>\r\n    )\r\n}\r\n\r\nexport default OfflineUseAlerts","import React, { useState, useEffect } from \"react\"\r\nimport { useTheme } from \"@material-ui/core/styles\"\r\n\r\nimport Canvas from \"./components/Canvas/Canvas.js\"\r\nimport BottomBar from \"./components/BottomBar/BottomBar.js\"\r\nimport Analytics from \"./utils/Analytics.js\"\r\nimport OfflineUseAlerts from \"./utils/OfflineUseAlerts.js\"\r\nimport { setCSSVariable } from \"./utils/style.js\"\r\n\r\nconst AppContext = React.createContext()\r\n\r\n/**\r\n * If the screen is wider than maxRatio% of the height, set\r\n * the width to constraintTo * height.\r\n */\r\nconst maxRatio = 1\r\nconst constrainTo = .65\r\n\r\nfunction getWidth() {\r\n    if (window.outerWidth / window.outerHeight > maxRatio) {\r\n        return window.outerHeight * constrainTo\r\n    }\r\n\r\n    return window.outerWidth\r\n}\r\n\r\nfunction App({ injectedImage = null }) {\r\n    const theme = useTheme()\r\n\r\n    const [context, setContext] = useState({\r\n        event: new EventTarget(),\r\n        image: injectedImage,\r\n        label: null,\r\n        currentTemplate: null,\r\n        password: localStorage.getItem(\"password\"),\r\n        width: getWidth()\r\n    })\r\n\r\n    const setter = {\r\n        set: values => setContext({ ...context, ...values }),\r\n        setPassword: password => {\r\n            // Store password in localstorage\r\n            localStorage.setItem(\"password\", password)\r\n            setContext({ ...context, password })\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        const handleUndo = (event) => {\r\n            // Detect ctrl + z\r\n            if(event.ctrlKey && event.keyCode === 90) {\r\n                context.event.dispatchEvent(new CustomEvent(\"undo\"))\r\n            }\r\n        }\r\n\r\n        window.addEventListener(\"keydown\", handleUndo)\r\n\r\n        return () => window.removeEventListener(\"keydown\", handleUndo)\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        // Handle image injection\r\n        const handleMessage = (message) => {\r\n            if (message.data.image) {\r\n                setContext({\r\n                    ...context,\r\n                    image: message.data.image,\r\n                    label: message.data.label\r\n                })\r\n            }\r\n        }\r\n\r\n        // Reset dimensions\r\n        const handleResize = () => {\r\n            setter.set({ width: getWidth() })\r\n        }\r\n\r\n        window.addEventListener(\"message\", handleMessage)\r\n        window.addEventListener(\"resize\", handleResize)\r\n        \r\n        return () => {\r\n            window.removeEventListener(\"message\", handleMessage)\r\n            window.removeEventListener(\"resize\", handleResize)\r\n        }\r\n    })\r\n\r\n    useEffect(() => {\r\n        // Apply width\r\n        setCSSVariable(\"width\", context.width + \"px\")\r\n    }, [context.width])\r\n\r\n    useEffect(() => {\r\n        // Set root's shadow\r\n        document.getElementById(\"root\").style.boxShadow = theme.shadows[4]\r\n    }, [theme])\r\n\r\n    return (\r\n        <AppContext.Provider value={{ ...context, ...setter }}>\r\n            <Analytics/>\r\n            <OfflineUseAlerts/>\r\n            \r\n            <Canvas/>\r\n            <BottomBar/>\r\n        </AppContext.Provider>\r\n    )\r\n}\r\n\r\nexport default App\r\n\r\nexport {\r\n    AppContext\r\n}","export function setCSSVariable(key, value) {\r\n    document.documentElement.style.setProperty(\"--\" + key, value)\r\n}","const isLocalhost = Boolean(\r\n    window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n        /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nconst channel = new BroadcastChannel(\"sw-0\")\r\n\r\nexport function register(config) {\r\n    if (process.env.NODE_ENV === 'production' &&'serviceWorker' in navigator) {\r\n        // The URL constructor is available in all browsers that support SW.\r\n        const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n        if (publicUrl.origin !== window.location.origin) {\r\n            // Our service worker won't work if PUBLIC_URL is on a different origin\r\n            // from what our page is served on. This might happen if a CDN is used to\r\n            // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n            return;\r\n        }\r\n\r\n        window.addEventListener('load', () => {\r\n            const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n            if (isLocalhost) {\r\n                // This is running on localhost. Let's check if a service worker still exists or not.\r\n                checkValidServiceWorker(swUrl, config);\r\n\r\n                // Add some additional logging to localhost, pointing developers to the\r\n                // service worker/PWA documentation.\r\n                navigator.serviceWorker.ready.then(() => {\r\n                    console.log(\r\n                        'This web app is being served cache-first by a service ' +\r\n                        'worker. To learn more, visit https://cra.link/PWA'\r\n                    );\r\n                });\r\n            } else {\r\n                // Is not localhost. Just register service worker\r\n                registerValidSW(swUrl, config);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n    navigator.serviceWorker\r\n        .register(swUrl)\r\n        .then(registration => {\r\n            registration.onupdatefound = () => {\r\n                const installingWorker = registration.installing;\r\n\r\n                if (installingWorker == null) {\r\n                    return;\r\n                }\r\n\r\n                installingWorker.onstatechange = () => {\r\n                    if (installingWorker.state === 'installed') {\r\n                        if (navigator.serviceWorker.controller) {\r\n                            // At this point, the updated precached content has been fetched,\r\n                            // but the previous service worker will still serve the older\r\n                            // content until all client tabs are closed.\r\n                            channel.postMessage(\"content-available\")\r\n                            console.log(\r\n                                'New content is available and will be used when all ' +\r\n                                'tabs for this page are closed. See https://cra.link/PWA.'\r\n                            );\r\n\r\n                            // Execute callback\r\n                            if (config && config.onUpdate) {\r\n                                config.onUpdate(registration);\r\n                            }\r\n                        } else {\r\n                            // At this point, everything has been precached.\r\n                            // It's the perfect time to display a\r\n                            // \"Content is cached for offline use.\" message.\r\n                            channel.postMessage(\"content-cached\")\r\n                            console.log('Content is cached for offline use.');\r\n\r\n                            // Execute callback\r\n                            if (config && config.onSuccess) {\r\n                                config.onSuccess(registration);\r\n                            }\r\n                        }\r\n                    }\r\n                };\r\n            };\r\n        })\r\n        .catch(error => {\r\n            console.error('Error during service worker registration:', error);\r\n        });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n    // Check if the service worker can be found. If it can't reload the page.\r\n    fetch(swUrl, {\r\n        headers: { 'Service-Worker': 'script' },\r\n    })\r\n        .then(response => {\r\n            // Ensure service worker exists, and that we really are getting a JS file.\r\n            const contentType = response.headers.get('content-type');\r\n            if (\r\n                response.status === 404 ||\r\n                (contentType != null && contentType.indexOf('javascript') === -1)\r\n            ) {\r\n                // No service worker found. Probably a different app. Reload the page.\r\n                navigator.serviceWorker.ready.then(registration => {\r\n                    registration.unregister().then(() => {\r\n                        window.location.reload();\r\n                    });\r\n                });\r\n            } else {\r\n                // Service worker found. Proceed as normal.\r\n                registerValidSW(swUrl, config);\r\n            }\r\n        })\r\n        .catch(() => {\r\n            console.log(\r\n                'No internet connection found. App is running in offline mode.'\r\n            );\r\n        });\r\n}\r\n\r\nexport function unregister() {\r\n    if ('serviceWorker' in navigator) {\r\n        navigator.serviceWorker.ready\r\n            .then(registration => {\r\n                registration.unregister();\r\n            })\r\n            .catch(error => {\r\n                console.error(error.message);\r\n            });\r\n    }\r\n}\r\n","import React from \"react\"\r\nimport ReactDOM from \"react-dom\"\r\nimport { createMuiTheme, ThemeProvider } from \"@material-ui/core/styles\"\r\n\r\nimport App from \"./App.js\"\r\nimport { IS_DEV } from \"./config/constants.js\"\r\nimport * as serviceWorker from \"./serviceWorker.js\"\r\nimport \"./index.css\"\r\n\r\nconst theme = createMuiTheme({\r\n    palette: {\r\n        type: \"dark\",\r\n        primary: {\r\n            main: \"#BB86FC\",\r\n            variant: \"#3700B3\"\r\n        }\r\n    }\r\n})\r\n\r\nif(IS_DEV) {\r\n    console.log(theme)\r\n}\r\n\r\nReactDOM.render((\r\n    <ThemeProvider theme={theme}>\r\n        <App/>\r\n    </ThemeProvider>\r\n), document.getElementById(\"root\"))\r\n\r\nserviceWorker.register()"],"sourceRoot":""}